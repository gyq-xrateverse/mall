# 02-1-1: 认证系统枚举类定义

## 任务概述
**时间**: 第1天上午 (2小时)  
**目标**: 定义认证系统相关的所有枚举类  
**优先级**: 最高  
**依赖**: 数据库表结构设计完成

## 详细任务清单

### 1.1 用户相关枚举类

#### 1.1.1 注册方式枚举
```java
// enums/RegisterType.java
package com.beilv.enums;

import lombok.AllArgsConstructor;
import lombok.Getter;

/**
 * 注册方式枚举
 * 对应数据库字段: ums_member.register_type
 */
@Getter
@AllArgsConstructor
public enum RegisterType {
    EMAIL(1, "email", "邮箱注册"),
    WECHAT(2, "wechat", "微信注册"),
    GOOGLE(3, "google", "谷歌注册");
    
    private final Integer code;
    private final String type;
    private final String description;
    
    /**
     * 根据code获取枚举
     */
    public static RegisterType fromCode(Integer code) {
        for (RegisterType type : values()) {
            if (type.getCode().equals(code)) {
                return type;
            }
        }
        throw new IllegalArgumentException("Invalid RegisterType code: " + code);
    }
    
    /**
     * 根据type获取枚举
     */
    public static RegisterType fromType(String type) {
        for (RegisterType registerType : values()) {
            if (registerType.getType().equals(type)) {
                return registerType;
            }
        }
        throw new IllegalArgumentException("Invalid RegisterType type: " + type);
    }
}
```

#### 1.1.2 邮箱验证状态枚举
```java
// enums/EmailVerifyStatus.java
package com.beilv.enums;

import lombok.AllArgsConstructor;
import lombok.Getter;

/**
 * 邮箱验证状态枚举
 * 对应数据库字段: ums_member.email_verified
 */
@Getter
@AllArgsConstructor
public enum EmailVerifyStatus {
    UNVERIFIED(0, "未验证"),
    VERIFIED(1, "已验证");
    
    private final Integer code;
    private final String description;
    
    /**
     * 根据code获取枚举
     */
    public static EmailVerifyStatus fromCode(Integer code) {
        for (EmailVerifyStatus status : values()) {
            if (status.getCode().equals(code)) {
                return status;
            }
        }
        throw new IllegalArgumentException("Invalid EmailVerifyStatus code: " + code);
    }
    
    /**
     * 判断是否已验证
     */
    public boolean isVerified() {
        return this == VERIFIED;
    }
}
```

#### 1.1.3 账户状态枚举
```java
// enums/AccountStatus.java
package com.beilv.enums;

import lombok.AllArgsConstructor;
import lombok.Getter;

/**
 * 账户状态枚举
 * 对应数据库字段: ums_member.account_status
 */
@Getter
@AllArgsConstructor
public enum AccountStatus {
    NORMAL(1, "正常"),
    FROZEN(2, "冻结"),
    DISABLED(3, "禁用");
    
    private final Integer code;
    private final String description;
    
    /**
     * 根据code获取枚举
     */
    public static AccountStatus fromCode(Integer code) {
        for (AccountStatus status : values()) {
            if (status.getCode().equals(code)) {
                return status;
            }
        }
        throw new IllegalArgumentException("Invalid AccountStatus code: " + code);
    }
    
    /**
     * 判断账户是否正常
     */
    public boolean isNormal() {
        return this == NORMAL;
    }
    
    /**
     * 判断账户是否可用
     */
    public boolean isAvailable() {
        return this == NORMAL;
    }
}
```

### 1.2 验证码相关枚举类

#### 1.2.1 验证码类型枚举
```java
// enums/CodeType.java
package com.beilv.enums;

import lombok.AllArgsConstructor;
import lombok.Getter;

/**
 * 验证码类型枚举
 * 对应数据库字段: ums_verification_codes.code_type
 */
@Getter
@AllArgsConstructor
public enum CodeType {
    REGISTER(1, "register", "注册"),
    LOGIN(2, "login", "登录"),
    RESET_PASSWORD(3, "reset", "重置密码");
    
    private final Integer code;
    private final String type;
    private final String description;
    
    /**
     * 根据code获取枚举
     */
    public static CodeType fromCode(Integer code) {
        for (CodeType type : values()) {
            if (type.getCode().equals(code)) {
                return type;
            }
        }
        throw new IllegalArgumentException("Invalid CodeType code: " + code);
    }
    
    /**
     * 根据type获取枚举
     */
    public static CodeType fromType(String type) {
        for (CodeType codeType : values()) {
            if (codeType.getType().equals(type)) {
                return codeType;
            }
        }
        throw new IllegalArgumentException("Invalid CodeType type: " + type);
    }
}
```

#### 1.2.2 验证码使用状态枚举
```java
// enums/CodeUsedStatus.java
package com.beilv.enums;

import lombok.AllArgsConstructor;
import lombok.Getter;

/**
 * 验证码使用状态枚举
 * 对应数据库字段: ums_verification_codes.used_status
 */
@Getter
@AllArgsConstructor
public enum CodeUsedStatus {
    UNUSED(0, "未使用"),
    USED(1, "已使用");
    
    private final Integer code;
    private final String description;
    
    /**
     * 根据code获取枚举
     */
    public static CodeUsedStatus fromCode(Integer code) {
        for (CodeUsedStatus status : values()) {
            if (status.getCode().equals(code)) {
                return status;
            }
        }
        throw new IllegalArgumentException("Invalid CodeUsedStatus code: " + code);
    }
    
    /**
     * 判断是否未使用
     */
    public boolean isUnused() {
        return this == UNUSED;
    }
    
    /**
     * 判断是否已使用
     */
    public boolean isUsed() {
        return this == USED;
    }
}
```

### 1.3 邮件相关枚举类

#### 1.3.1 邮件类型枚举
```java
// enums/EmailType.java
package com.beilv.enums;

import lombok.AllArgsConstructor;
import lombok.Getter;

/**
 * 邮件类型枚举
 * 用于邮件模板和主题选择
 */
@Getter
@AllArgsConstructor
public enum EmailType {
    REGISTER("register", "注册", "欢迎注册白鹿AI"),
    LOGIN("login", "登录", "登录验证"),
    RESET("reset", "密码重置", "密码重置");
    
    private final String type;
    private final String description;
    private final String subject;
    
    /**
     * 根据type获取枚举
     */
    public static EmailType fromType(String type) {
        for (EmailType emailType : values()) {
            if (emailType.getType().equals(type)) {
                return emailType;
            }
        }
        return REGISTER; // 默认返回注册类型
    }
    
    /**
     * 获取邮件完整主题
     */
    public String getFullSubject() {
        return "BEILV AI - " + this.subject + "验证码";
    }
}
```

### 1.4 第三方登录相关枚举类

#### 1.4.1 第三方平台枚举
```java
// enums/ThirdPartyProvider.java
package com.beilv.enums;

import lombok.AllArgsConstructor;
import lombok.Getter;

/**
 * 第三方平台枚举
 * 对应数据库字段: ums_third_party_auth.provider
 */
@Getter
@AllArgsConstructor
public enum ThirdPartyProvider {
    WECHAT("wechat", "微信", "https://api.weixin.qq.com"),
    GOOGLE("google", "谷歌", "https://accounts.google.com");
    
    private final String provider;
    private final String description;
    private final String baseUrl;
    
    /**
     * 根据provider获取枚举
     */
    public static ThirdPartyProvider fromProvider(String provider) {
        for (ThirdPartyProvider p : values()) {
            if (p.getProvider().equals(provider)) {
                return p;
            }
        }
        throw new IllegalArgumentException("Invalid ThirdPartyProvider: " + provider);
    }
    
    /**
     * 判断是否为微信
     */
    public boolean isWechat() {
        return this == WECHAT;
    }
    
    /**
     * 判断是否为Google
     */
    public boolean isGoogle() {
        return this == GOOGLE;
    }
}
```

#### 1.4.2 令牌状态枚举
```java
// enums/TokenStatus.java
package com.beilv.enums;

import lombok.AllArgsConstructor;
import lombok.Getter;

/**
 * 令牌状态枚举
 * 对应第三方授权token的状态管理
 */
@Getter
@AllArgsConstructor
public enum TokenStatus {
    VALID(1, "有效"),
    EXPIRED(2, "已过期"),
    REVOKED(3, "已撤销");
    
    private final Integer code;
    private final String description;
    
    /**
     * 根据code获取枚举
     */
    public static TokenStatus fromCode(Integer code) {
        for (TokenStatus status : values()) {
            if (status.getCode().equals(code)) {
                return status;
            }
        }
        throw new IllegalArgumentException("Invalid TokenStatus code: " + code);
    }
    
    /**
     * 判断令牌是否有效
     */
    public boolean isValid() {
        return this == VALID;
    }
}
```

### 1.5 枚举类工具类

#### 1.5.1 枚举转换工具类
```java
// utils/EnumUtils.java
package com.beilv.utils;

import com.beilv.enums.*;

/**
 * 枚举转换工具类
 * 提供统一的枚举转换方法
 */
public class EnumUtils {
    
    /**
     * 安全转换注册方式枚举
     */
    public static RegisterType safeFromRegisterCode(Integer code) {
        try {
            return code != null ? RegisterType.fromCode(code) : RegisterType.EMAIL;
        } catch (IllegalArgumentException e) {
            return RegisterType.EMAIL;
        }
    }
    
    /**
     * 安全转换账户状态枚举
     */
    public static AccountStatus safeFromAccountCode(Integer code) {
        try {
            return code != null ? AccountStatus.fromCode(code) : AccountStatus.NORMAL;
        } catch (IllegalArgumentException e) {
            return AccountStatus.NORMAL;
        }
    }
    
    /**
     * 安全转换邮箱验证状态枚举
     */
    public static EmailVerifyStatus safeFromEmailVerifyCode(Integer code) {
        try {
            return code != null ? EmailVerifyStatus.fromCode(code) : EmailVerifyStatus.UNVERIFIED;
        } catch (IllegalArgumentException e) {
            return EmailVerifyStatus.UNVERIFIED;
        }
    }
    
    /**
     * 安全转换验证码类型枚举
     */
    public static CodeType safeFromCodeType(String type) {
        try {
            return type != null ? CodeType.fromType(type) : CodeType.REGISTER;
        } catch (IllegalArgumentException e) {
            return CodeType.REGISTER;
        }
    }
    
    /**
     * 安全转换第三方平台枚举
     */
    public static ThirdPartyProvider safeFromProvider(String provider) {
        try {
            return provider != null ? ThirdPartyProvider.fromProvider(provider) : null;
        } catch (IllegalArgumentException e) {
            return null;
        }
    }
}
```

## 验收标准
- [x] 所有状态字段都有对应枚举类
- [x] 枚举类包含code、type/provider、description字段
- [x] 提供fromCode和fromType转换方法
- [x] 枚举值与数据库字段注释一致
- [x] 包含业务判断方法（如isValid、isNormal等）
- [x] 提供安全转换工具类
- [x] 完整的异常处理机制
- [x] 符合Java命名规范和代码风格

## 交付物
- [x] RegisterType.java - 注册方式枚举
- [x] EmailVerifyStatus.java - 邮箱验证状态枚举  
- [x] AccountStatus.java - 账户状态枚举
- [x] CodeType.java - 验证码类型枚举
- [x] CodeUsedStatus.java - 验证码使用状态枚举
- [x] EmailType.java - 邮件类型枚举
- [x] ThirdPartyProvider.java - 第三方平台枚举
- [x] TokenStatus.java - 令牌状态枚举
- [x] EnumUtils.java - 枚举转换工具类

## 验证测试
1. 编译所有枚举类无错误
2. 测试fromCode和fromType方法
3. 验证异常处理机制
4. 测试业务判断方法
5. 检查工具类转换功能

## 风险控制
- **类型安全**: 所有枚举转换都有异常处理
- **向后兼容**: 新增枚举值不影响现有功能
- **数据一致性**: 枚举值与数据库约束保持一致

## 下一步
完成后集成到 `02-1-2-邮件服务实现`