# 02-3-2: 注册页面组件

## 任务概述
**时间估算**: 2小时  
**优先级**: 高  
**依赖关系**: 02-3-1 登录页面组件完成  
**负责模块**: 前端React应用

## 详细任务清单

### 1. 创建注册页面组件结构
- [ ] 创建pages/auth/Register.tsx注册页面组件
- [ ] 设计响应式布局结构
- [ ] 配置页面路由和导航
- [ ] 添加页面标题和SEO配置

### 2. 实现邮箱验证码注册表单
- [ ] 创建邮箱输入字段（带实时验证）
- [ ] 创建验证码输入字段
- [ ] 创建用户名输入字段
- [ ] 创建密码输入字段（可选）
- [ ] 实现发送验证码按钮（带倒计时）

### 3. 添加注册协议和条款
- [ ] 创建用户协议和隐私政策链接
- [ ] 实现协议同意复选框
- [ ] 添加协议弹窗或页面
- [ ] 强制协议同意验证

### 4. 实现表单验证逻辑
- [ ] 邮箱格式验证（实时）
- [ ] 用户名长度和格式验证
- [ ] 密码强度验证（可选）
- [ ] 验证码格式验证
- [ ] 协议同意状态验证

### 5. 实现注册状态管理
- [ ] 使用useRegister Hook管理注册逻辑
- [ ] 处理注册Loading状态
- [ ] 显示注册错误信息
- [ ] 注册成功后跳转处理

### 6. 设计页面样式和交互
- [ ] 使用Tailwind CSS设计现代UI
- [ ] 实现暗色模式支持
- [ ] 添加表单动画效果
- [ ] 实现响应式设计（移动端适配）
- [ ] 与登录页面保持一致的设计风格

### 7. 实现验证码发送功能
- [ ] 验证码发送按钮状态管理
- [ ] 60秒倒计时显示
- [ ] 发送频率限制处理
- [ ] 发送成功/失败提示
- [ ] 邮箱验证后才能发送

### 8. 添加页面导航和用户引导
- [ ] 添加"已有账号？立即登录"链接
- [ ] 实现注册步骤指示器（可选）
- [ ] 添加注册成功提示
- [ ] 实现页面间平滑切换

### 9. 优化用户体验
- [ ] 自动聚焦第一个输入框
- [ ] 回车键切换到下一个字段
- [ ] 密码显示/隐藏切换
- [ ] 表单填写进度指示
- [ ] 错误信息自动清除

## 验收标准
- [x] 注册页面UI美观且响应式
- [x] 邮箱验证码注册功能正常
- [x] 表单验证规则完整有效
- [x] 用户协议强制同意机制
- [x] 错误处理友好用户体验好
- [x] 移动端适配良好
- [x] 注册成功后正确跳转

## 交付物
1. **注册页面组件**（Register.tsx）
2. **注册表单组件**（RegisterForm.tsx）
3. **协议同意组件**（TermsAgreement.tsx）
4. **密码强度指示器**（PasswordStrength.tsx）
5. **类型定义文件**（register.types.ts）

## 技术要点

### 组件结构
```typescript
const Register: React.FC = () => {
  const [formData, setFormData] = useState({
    email: '',
    code: '',
    username: '',
    password: '',
    agreeToTerms: false
  });
  
  const [countdown, setCountdown] = useState(0);
  const { register, loading, error } = useRegister();
  
  return (
    <div className="min-h-screen flex items-center justify-center">
      <div className="max-w-md w-full space-y-8">
        {/* 注册表单 */}
      </div>
    </div>
  );
};
```

### 表单验证规则
```typescript
const validateForm = (data: RegisterFormData): ValidationErrors => {
  const errors: ValidationErrors = {};
  
  if (!data.email) {
    errors.email = '邮箱不能为空';
  } else if (!validateEmail(data.email)) {
    errors.email = '请输入有效的邮箱地址';
  }
  
  if (!data.username) {
    errors.username = '用户名不能为空';
  } else if (data.username.length < 2 || data.username.length > 20) {
    errors.username = '用户名长度在2-20个字符';
  }
  
  if (data.password && data.password.length < 6) {
    errors.password = '密码至少6个字符';
  }
  
  if (!data.code) {
    errors.code = '验证码不能为空';
  } else if (!/^\d{6}$/.test(data.code)) {
    errors.code = '验证码必须是6位数字';
  }
  
  if (!data.agreeToTerms) {
    errors.agreeToTerms = '请阅读并同意用户协议和隐私政策';
  }
  
  return errors;
};
```

### 验证码发送逻辑
```typescript
const sendVerificationCode = async () => {
  if (!formData.email || !validateEmail(formData.email)) {
    setFieldError('email', '请输入有效的邮箱地址');
    return;
  }
  
  try {
    await authApi.sendVerificationCode({
      email: formData.email,
      codeType: 'register'
    });
    
    setCountdown(60);
    startCountdown();
    showSuccessMessage('验证码已发送，请查收邮件');
  } catch (error) {
    showErrorMessage('验证码发送失败，请稍后重试');
  }
};
```

### 协议同意组件
```typescript
const TermsAgreement: React.FC<{
  checked: boolean;
  onChange: (checked: boolean) => void;
}> = ({ checked, onChange }) => {
  return (
    <div className="flex items-start">
      <input
        type="checkbox"
        checked={checked}
        onChange={(e) => onChange(e.target.checked)}
        className="mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
      />
      <div className="ml-3 text-sm">
        <span className="text-gray-700">
          我已阅读并同意
          <a href="/terms" className="text-blue-600 hover:text-blue-500 mx-1">
            《用户协议》
          </a>
          和
          <a href="/privacy" className="text-blue-600 hover:text-blue-500 mx-1">
            《隐私政策》
          </a>
        </span>
      </div>
    </div>
  );
};
```

### 密码强度指示器
```typescript
const PasswordStrength: React.FC<{ password: string }> = ({ password }) => {
  const strength = calculatePasswordStrength(password);
  
  return (
    <div className="mt-2">
      <div className="flex space-x-1">
        {[1, 2, 3, 4].map((level) => (
          <div
            key={level}
            className={`h-1 w-1/4 rounded ${
              strength >= level ? getStrengthColor(strength) : 'bg-gray-200'
            }`}
          />
        ))}
      </div>
      <p className="text-xs text-gray-500 mt-1">
        {getStrengthText(strength)}
      </p>
    </div>
  );
};
```

## 表单字段设计
- **邮箱字段**: 必填，格式验证，实时验证
- **验证码字段**: 必填，6位数字，验证码发送后启用
- **用户名字段**: 必填，2-20字符，支持中英文数字
- **密码字段**: 可选，最少6位，强度指示
- **协议同意**: 必填复选框，链接到协议页面

## 用户体验优化
- 表单字段自动聚焦和跳转
- 实时验证反馈
- 友好的错误提示
- 注册成功动画
- 加载状态指示
- 防重复提交

## 响应式设计
- 移动端优先
- 触摸友好的交互
- 合适的字体大小
- 适配各种屏幕尺寸

## 安全考虑
- 客户端表单验证
- 密码输入脱敏
- 防止自动填充（可选）
- HTTPS传输确保

## 下一步
完成后进入 `02-3-3-认证状态管理`