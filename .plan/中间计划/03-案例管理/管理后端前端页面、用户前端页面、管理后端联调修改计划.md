# æ¡ˆä¾‹ç®¡ç†æ–‡ä»¶å­˜å‚¨æ”¹é€ è®¡åˆ’

## é¡¹ç›®æ¦‚è¿°

åŸºäºç°æœ‰çš„æ–‡ä»¶å­˜å‚¨æœåŠ¡ï¼ˆMinIO/OSSï¼‰ï¼Œå°†æ¡ˆä¾‹ç®¡ç†ç³»ç»Ÿçš„å›¾ç‰‡å’Œè§†é¢‘ä¸Šä¼ åŠŸèƒ½æ”¹é€ ä¸ºä½¿ç”¨ç»Ÿä¸€çš„æ–‡ä»¶å­˜å‚¨å·¥å…·ï¼Œå®ç°ç®¡ç†åç«¯å’Œç”¨æˆ·å‰ç«¯çš„åª’ä½“æ–‡ä»¶ç»Ÿä¸€ç®¡ç†ã€‚

## ç°çŠ¶åˆ†æ

### 1. æ–‡ä»¶å­˜å‚¨æœåŠ¡ç°çŠ¶
- âœ… **åç«¯APIå®Œå–„**: å·²æœ‰å®Œæ•´çš„FileStorageServiceæ¥å£
- âœ… **å¤šå­˜å‚¨æ”¯æŒ**: æ”¯æŒMinIOå’Œé˜¿é‡Œäº‘OSS
- âœ… **æµ‹è¯•é€šè¿‡**: RealFileUploadTest.javaæµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡
- âœ… **URLç®¡ç†**: æ”¯æŒæ™®é€šURLå’ŒCDN URLæ„å»º

### 2. ç®¡ç†åç«¯ç°çŠ¶
- âœ… **ç»„ä»¶åŒ–è®¾è®¡**: æ ¸å¿ƒé€»è¾‘é›†ä¸­åœ¨CaseDataDetail.vue
- âœ… **ä¸Šä¼ ç»„ä»¶**: å·²æœ‰singleUploadå’ŒvideoUploadç»„ä»¶
- âš ï¸ **å­˜å‚¨æ–¹å¼**: å½“å‰ä½¿ç”¨OSS/MinIOï¼Œéœ€ç»Ÿä¸€åˆ°FileStorageService
- âš ï¸ **åª’ä½“ç±»å‹**: ä»…æ”¯æŒè§†é¢‘+å°é¢æ¨¡å¼ï¼Œä¸å¤Ÿçµæ´»

### 3. ç”¨æˆ·å‰ç«¯ç°çŠ¶
- âœ… **åŸºç¡€æ¶æ„**: React + Reduxæ¶æ„å®Œå–„
- âœ… **æ¡ˆä¾‹å±•ç¤º**: ç€‘å¸ƒæµå¸ƒå±€ï¼Œæ”¯æŒåˆ†ç±»ç­›é€‰
- âš ï¸ **åª’ä½“æ’­æ”¾**: ä»…æ˜¾ç¤ºå°é¢ï¼Œç¼ºå°‘è§†é¢‘æ’­æ”¾åŠŸèƒ½
- âš ï¸ **æ–‡ä»¶ä¸Šä¼ **: é€šç”¨ä¸Šä¼ ï¼Œä¸æ”¯æŒè§†é¢‘é¢„è§ˆ

## æ”¹é€ ç›®æ ‡

### æ ¸å¿ƒç›®æ ‡
1. **ç»Ÿä¸€æ–‡ä»¶å­˜å‚¨**: æ‰€æœ‰åª’ä½“æ–‡ä»¶ä½¿ç”¨FileStorageService
2. **å¢å¼ºåª’ä½“æ”¯æŒ**: æ”¯æŒå›¾ç‰‡ã€è§†é¢‘ã€å›¾æ–‡æ··åˆç­‰å¤šç§æ¡ˆä¾‹ç±»å‹
3. **å®Œå–„ç”¨æˆ·ä½“éªŒ**: è§†é¢‘æ’­æ”¾ã€åª’ä½“é¢„è§ˆã€å“åº”å¼è®¾è®¡
4. **ä¿æŒæ•°æ®ä¸€è‡´**: æ•°æ®åº“å­˜å‚¨objectNameï¼Œå‰ç«¯æ„å»ºå®Œæ•´URL

### æŠ€æœ¯ç›®æ ‡
- å¤ç”¨ç°æœ‰FileStorageService API
- æœ€å°åŒ–ä»£ç æ”¹åŠ¨
- ä¿æŒå‘åå…¼å®¹
- ä¼˜åŒ–æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
- **é¿å…èµ„æºæµªè´¹**: å®ç°æ–‡ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œé˜²æ­¢å­¤å„¿æ–‡ä»¶äº§ç”Ÿ

## è¯¦ç»†æ”¹é€ è®¡åˆ’

## ç¬¬ä¸€é˜¶æ®µï¼šç®¡ç†åç«¯æ”¹é€ 

### 1.1 åç«¯APIç»Ÿä¸€ (ä¼˜å…ˆçº§: é«˜)

**ç›®æ ‡**: å°†æ¡ˆä¾‹ç®¡ç†APIç»Ÿä¸€ä½¿ç”¨FileStorageService

**æ”¹é€ å†…å®¹**:
```java
// 1. æ¡ˆä¾‹Controllerå¢åŠ æ–‡ä»¶ä¸Šä¼ æ¥å£
@RestController
@RequestMapping("/admin/case")
public class CaseController {

    @Autowired
    private FileStorageService fileStorageService;

    // æ–°å¢ï¼šæ¡ˆä¾‹æ–‡ä»¶ä¸Šä¼ æ¥å£
    @PostMapping("/upload")
    public CommonResult<FileUploadResult> uploadCaseFile(
        @RequestParam("file") MultipartFile file) {
        try {
            FileUploadResult result = fileStorageService.uploadFile(file);
            return CommonResult.success(result);
        } catch (Exception e) {
            return CommonResult.failed("æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼š" + e.getMessage());
        }
    }

    // æ–°å¢ï¼šæ–‡ä»¶åˆ é™¤æ¥å£
    @DeleteMapping("/upload/{objectName}")
    public CommonResult<Boolean> deleteCaseFile(@PathVariable String objectName) {
        boolean success = fileStorageService.deleteFile(objectName);
        return success ? CommonResult.success(true) : CommonResult.failed("åˆ é™¤å¤±è´¥");
    }
}
```

**ä¿®æ”¹æ–‡ä»¶**:
- `CaseController.java` - æ·»åŠ æ–‡ä»¶ä¸Šä¼ æ¥å£
- `CaseService.java` - æ·»åŠ æ–‡ä»¶ç®¡ç†é€»è¾‘

### 1.2 å‰ç«¯ä¸Šä¼ ç»„ä»¶æ”¹é€  (ä¼˜å…ˆçº§: é«˜)

**ç›®æ ‡**: æ”¹é€ Vueä¸Šä¼ ç»„ä»¶ä½¿ç”¨æ–°çš„API

**1.2.1 åˆ›å»ºç»Ÿä¸€åª’ä½“ä¸Šä¼ ç»„ä»¶**

```vue
<!-- æ–°ç»„ä»¶: MediaUpload.vue -->
<template>
  <div class="media-upload">
    <el-upload
      :action="uploadUrl"
      :headers="headers"
      :on-success="handleSuccess"
      :on-error="handleError"
      :on-progress="handleProgress"
      :before-upload="beforeUpload"
      :show-file-list="false"
      drag>

      <!-- ä¸Šä¼ åŒºåŸŸ -->
      <div v-if="!mediaUrl" class="upload-area">
        <i class="el-icon-upload"></i>
        <div class="upload-text">
          {{ uploadText || 'ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„ä¸Šä¼ ' }}
        </div>
        <div class="upload-tip">{{ tipText }}</div>
      </div>

      <!-- é¢„è§ˆåŒºåŸŸ -->
      <div v-else class="preview-area">
        <!-- å›¾ç‰‡é¢„è§ˆ -->
        <el-image
          v-if="isImage"
          :src="mediaUrl"
          :preview-src-list="[mediaUrl]"
          style="width: 100%; height: 200px"
          fit="cover">
        </el-image>

        <!-- è§†é¢‘é¢„è§ˆ -->
        <video
          v-else-if="isVideo"
          :src="mediaUrl"
          controls
          style="width: 100%; height: 200px">
        </video>

        <!-- æ“ä½œæŒ‰é’® -->
        <div class="preview-actions">
          <el-button size="small" @click="handleReplace">æ›¿æ¢</el-button>
          <el-button size="small" type="danger" @click="handleDelete">åˆ é™¤</el-button>
        </div>
      </div>

      <!-- ä¸Šä¼ è¿›åº¦ -->
      <el-progress
        v-if="uploading"
        :percentage="uploadProgress"
        style="margin-top: 10px">
      </el-progress>
    </el-upload>
  </div>
</template>

<script>
export default {
  name: 'MediaUpload',
  props: {
    value: String,           // objectName
    mediaType: {            // 'image' | 'video' | 'all'
      type: String,
      default: 'all'
    },
    maxSize: {              // æ–‡ä»¶å¤§å°é™åˆ¶(MB)
      type: Number,
      default: 100
    },
    uploadText: String,     // ä¸Šä¼ æç¤ºæ–‡å­—
    tipText: String         // æç¤ºæ–‡å­—
  },

  data() {
    return {
      uploading: false,
      uploadProgress: 0,
      uploadUrl: '/admin/case/upload'
    }
  },

  computed: {
    headers() {
      return {
        'Authorization': 'Bearer ' + this.$store.getters.token
      }
    },

    mediaUrl() {
      return this.value ? this.buildUrl(this.value) : ''
    },

    isImage() {
      return this.value && this.isImageFile(this.value)
    },

    isVideo() {
      return this.value && this.isVideoFile(this.value)
    }
  },

  methods: {
    buildUrl(objectName) {
      // ä½¿ç”¨å…¨å±€å·¥å…·å‡½æ•°æ„å»ºå®Œæ•´URL
      return this.$buildMediaUrl(objectName)
    },

    beforeUpload(file) {
      // æ–‡ä»¶ç±»å‹éªŒè¯
      if (this.mediaType === 'image' && !this.isImageFile(file.name)) {
        this.$message.error('åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶')
        return false
      }

      if (this.mediaType === 'video' && !this.isVideoFile(file.name)) {
        this.$message.error('åªèƒ½ä¸Šä¼ è§†é¢‘æ–‡ä»¶')
        return false
      }

      // æ–‡ä»¶å¤§å°éªŒè¯
      const isLtMaxSize = file.size / 1024 / 1024 < this.maxSize
      if (!isLtMaxSize) {
        this.$message.error(`æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ ${this.maxSize}MB`)
        return false
      }

      this.uploading = true
      return true
    },

    handleProgress(event) {
      this.uploadProgress = Math.round(event.percent)
    },

    handleSuccess(response) {
      this.uploading = false
      this.uploadProgress = 0

      if (response.code === 200) {
        const objectName = response.data.objectName
        this.$emit('input', objectName)
        this.$message.success('ä¸Šä¼ æˆåŠŸ')
      } else {
        this.$message.error(response.message || 'ä¸Šä¼ å¤±è´¥')
      }
    },

    handleError(err) {
      this.uploading = false
      this.uploadProgress = 0
      this.$message.error('ä¸Šä¼ å¤±è´¥ï¼š' + err.message)
    },

    handleReplace() {
      // è§¦å‘é‡æ–°é€‰æ‹©æ–‡ä»¶
      this.$refs.upload.$el.querySelector('input').click()
    },

    async handleDelete() {
      try {
        const result = await this.$confirm('ç¡®è®¤åˆ é™¤è¯¥æ–‡ä»¶ï¼Ÿ', 'æç¤º', {
          type: 'warning'
        })

        if (result) {
          // è°ƒç”¨åˆ é™¤API
          await this.$http.delete(`/admin/case/upload/${this.value}`)
          this.$emit('input', '')
          this.$message.success('åˆ é™¤æˆåŠŸ')
        }
      } catch (error) {
        if (error !== 'cancel') {
          this.$message.error('åˆ é™¤å¤±è´¥')
        }
      }
    },

    isImageFile(filename) {
      const imageExts = ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp']
      return imageExts.some(ext => filename.toLowerCase().endsWith(ext))
    },

    isVideoFile(filename) {
      const videoExts = ['.mp4', '.avi', '.mov', '.mkv', '.wmv', '.flv']
      return videoExts.some(ext => filename.toLowerCase().endsWith(ext))
    }
  }
}
</script>
```

**1.2.2 æ”¹é€ æ¡ˆä¾‹ç¼–è¾‘ç»„ä»¶ï¼ˆä¿®æ­£ç‰ˆï¼‰**

æ ¹æ®å®é™…çš„CaseDataå®ä½“ç»“æ„ï¼Œä¸¥æ ¼æŒ‰ç…§æ•°æ®åº“å­—æ®µè®¾è®¡ï¼š

```vue
<!-- ä¿®æ”¹: CaseDataDetail.vue - å®Œå…¨å¯¹åº”CaseDataå®ä½“ -->
<template>
  <div class="case-data-detail">
    <el-form :model="caseData" :rules="rules" ref="caseForm" label-width="120px">

      <!-- åŸºç¡€ä¿¡æ¯ -->
      <el-form-item label="æ¡ˆä¾‹æ ‡é¢˜ï¼š" prop="title">
        <el-input v-model="caseData.title" placeholder="è¯·è¾“å…¥æ¡ˆä¾‹æ ‡é¢˜"></el-input>
      </el-form-item>

      <el-form-item label="æ¡ˆä¾‹åˆ†ç±»ï¼š" prop="categoryId">
        <el-select v-model="caseData.categoryId" placeholder="è¯·é€‰æ‹©æ¡ˆä¾‹åˆ†ç±»">
          <el-option
            v-for="category in categories"
            :key="category.id"
            :label="category.name"
            :value="category.id">
          </el-option>
        </el-select>
      </el-form-item>

      <!-- å›¾ç‰‡ä¸Šä¼ ï¼ˆæœ¬åœ°æš‚å­˜ï¼‰ -->
      <el-form-item label="æ¡ˆä¾‹å›¾ç‰‡ï¼š" prop="image">
        <div class="upload-section">
          <el-upload
            :show-file-list="false"
            :before-upload="beforeImageUpload"
            action=""
            :auto-upload="false">
            <el-button size="small" type="primary">é€‰æ‹©å›¾ç‰‡</el-button>
          </el-upload>

          <!-- å›¾ç‰‡é¢„è§ˆ -->
          <div v-if="imagePreviewUrl || caseData.image" class="preview-container">
            <img
              :src="imagePreviewUrl || buildUrl(caseData.image)"
              style="width: 200px; height: 150px; object-fit: cover; border-radius: 4px;"
            />
            <div class="preview-actions">
              <el-button size="mini" @click="removeImage">åˆ é™¤</el-button>
            </div>
          </div>
        </div>
        <div class="input-tip">ç”¨äºåˆ—è¡¨å±•ç¤ºçš„å›¾ç‰‡ï¼Œæ”¯æŒjpgã€pngæ ¼å¼ï¼Œä¸è¶…è¿‡10MB</div>
      </el-form-item>

      <!-- è§†é¢‘ä¸Šä¼ ï¼ˆæœ¬åœ°æš‚å­˜ï¼‰ -->
      <el-form-item label="æ¡ˆä¾‹è§†é¢‘ï¼š" prop="video">
        <div class="upload-section">
          <el-upload
            :show-file-list="false"
            :before-upload="beforeVideoUpload"
            action=""
            :auto-upload="false">
            <el-button size="small" type="primary">é€‰æ‹©è§†é¢‘</el-button>
          </el-upload>

          <!-- è§†é¢‘é¢„è§ˆ -->
          <div v-if="videoPreviewUrl || caseData.video" class="preview-container">
            <video
              :src="videoPreviewUrl || buildUrl(caseData.video)"
              style="width: 300px; height: 200px;"
              controls>
            </video>
            <div class="preview-actions">
              <el-button size="mini" @click="removeVideo">åˆ é™¤</el-button>
            </div>
          </div>
        </div>
        <div class="input-tip">ç‚¹å‡»é¢„è§ˆçš„è§†é¢‘æ–‡ä»¶ï¼Œæ”¯æŒmp4ã€aviã€movæ ¼å¼ï¼Œä¸è¶…è¿‡500MB</div>
      </el-form-item>

      <!-- æ¡ˆä¾‹å†…å®¹ -->
      <el-form-item label="æ¡ˆä¾‹å†…å®¹ï¼š">
        <el-input
          v-model="caseData.content"
          type="textarea"
          :rows="4"
          placeholder="è¯·è¾“å…¥æ¡ˆä¾‹å†…å®¹æè¿°">
        </el-input>
      </el-form-item>

      <!-- æ ‡ç­¾ -->
      <el-form-item label="æ ‡ç­¾ï¼š">
        <el-select
          v-model="tagList"
          multiple
          filterable
          allow-create
          placeholder="è¯·é€‰æ‹©æˆ–è¾“å…¥æ ‡ç­¾">
          <el-option
            v-for="tag in availableTags"
            :key="tag"
            :label="tag"
            :value="tag">
          </el-option>
        </el-select>
        <div class="input-tip">æ ‡ç­¾ç”¨é€—å·åˆ†éš”ä¿å­˜</div>
      </el-form-item>

      <!-- çŠ¶æ€ -->
      <el-form-item label="çŠ¶æ€ï¼š">
        <el-radio-group v-model="caseData.status">
          <el-radio :label="1">å¯ç”¨</el-radio>
          <el-radio :label="0">ç¦ç”¨</el-radio>
        </el-radio-group>
      </el-form-item>

      <el-form-item label="æ˜¾ç¤ºçŠ¶æ€ï¼š">
        <el-radio-group v-model="caseData.showStatus">
          <el-radio :label="1">æ˜¾ç¤º</el-radio>
          <el-radio :label="0">ä¸æ˜¾ç¤º</el-radio>
        </el-radio-group>
      </el-form-item>

      <!-- æäº¤æŒ‰é’® -->
      <el-form-item>
        <el-button type="primary" @click="handleSubmit" :loading="submitting">
          {{ isEdit ? 'æ›´æ–°æ¡ˆä¾‹' : 'åˆ›å»ºæ¡ˆä¾‹' }}
        </el-button>
        <el-button @click="handleCancel">å–æ¶ˆ</el-button>
      </el-form-item>
    </el-form>
  </div>
</template>

<script>
export default {
  name: 'CaseDataDetail',
  props: {
    isEdit: {
      type: Boolean,
      default: false
    },
    caseId: String
  },

  data() {
    return {
      // ä¸¥æ ¼æŒ‰ç…§CaseDataå®ä½“å­—æ®µ
      caseData: {
        id: null,
        categoryId: null,        // åˆ†ç±»ID
        title: '',              // æ¡ˆä¾‹æ ‡é¢˜
        content: '',            // æ¡ˆä¾‹å†…å®¹
        image: '',              // å›¾ç‰‡ObjectName
        video: '',              // è§†é¢‘ObjectName
        tags: '',               // æ ‡ç­¾å­—ç¬¦ä¸²ï¼Œé€—å·åˆ†éš”
        status: 1,              // çŠ¶æ€
        showStatus: 1           // æ˜¾ç¤ºçŠ¶æ€
      },

      // å‰ç«¯è¾…åŠ©å­—æ®µï¼ˆä¸æäº¤åˆ°åç«¯ï¼‰
      tagList: [],              // æ ‡ç­¾æ•°ç»„ï¼Œç”¨äºå‰ç«¯ç¼–è¾‘
      imageFile: null,          // æœ¬åœ°æš‚å­˜çš„å›¾ç‰‡æ–‡ä»¶
      videoFile: null,          // æœ¬åœ°æš‚å­˜çš„è§†é¢‘æ–‡ä»¶
      imagePreviewUrl: '',      // å›¾ç‰‡é¢„è§ˆURL
      videoPreviewUrl: '',      // è§†é¢‘é¢„è§ˆURL
      submitting: false,

      rules: {
        title: [
          {required: true, message: 'è¯·è¾“å…¥æ¡ˆä¾‹æ ‡é¢˜', trigger: 'blur'}
        ],
        categoryId: [
          {required: true, message: 'è¯·é€‰æ‹©æ¡ˆä¾‹åˆ†ç±»', trigger: 'change'}
        ]
      },

      categories: [],
      availableTags: []
    }
  },

  methods: {
    // å›¾ç‰‡é€‰æ‹©å¤„ç†
    beforeImageUpload(file) {
      const isImage = /\.(jpg|jpeg|png|gif)$/i.test(file.name)
      const isLt10M = file.size / 1024 / 1024 < 10

      if (!isImage) {
        this.$message.error('åªèƒ½ä¸Šä¼ jpgã€pngã€gifæ ¼å¼çš„å›¾ç‰‡')
        return false
      }
      if (!isLt10M) {
        this.$message.error('å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡10MB')
        return false
      }

      this.imageFile = file
      this.imagePreviewUrl = URL.createObjectURL(file)
      return false // é˜»æ­¢è‡ªåŠ¨ä¸Šä¼ 
    },

    // è§†é¢‘é€‰æ‹©å¤„ç†
    beforeVideoUpload(file) {
      const isVideo = /\.(mp4|avi|mov|mkv|wmv)$/i.test(file.name)
      const isLt500M = file.size / 1024 / 1024 < 500

      if (!isVideo) {
        this.$message.error('åªèƒ½ä¸Šä¼ mp4ã€aviã€movç­‰æ ¼å¼çš„è§†é¢‘')
        return false
      }
      if (!isLt500M) {
        this.$message.error('è§†é¢‘å¤§å°ä¸èƒ½è¶…è¿‡500MB')
        return false
      }

      this.videoFile = file
      this.videoPreviewUrl = URL.createObjectURL(file)
      return false // é˜»æ­¢è‡ªåŠ¨ä¸Šä¼ 
    },

    removeImage() {
      this.imageFile = null
      this.imagePreviewUrl = ''
      if (this.isEdit) {
        // ç¼–è¾‘æ¨¡å¼ä¸‹åªæ¸…é™¤é¢„è§ˆï¼Œä¸æ¸…é™¤åŸå§‹æ•°æ®
      } else {
        this.caseData.image = ''
      }
    },

    removeVideo() {
      this.videoFile = null
      this.videoPreviewUrl = ''
      if (this.isEdit) {
        // ç¼–è¾‘æ¨¡å¼ä¸‹åªæ¸…é™¤é¢„è§ˆï¼Œä¸æ¸…é™¤åŸå§‹æ•°æ®
      } else {
        this.caseData.video = ''
      }
    },

    // æäº¤è¡¨å•
    async handleSubmit() {
      try {
        await this.$refs.caseForm.validate()

        if (!this.isEdit && (!this.imageFile || !this.videoFile)) {
          this.$message.error('è¯·é€‰æ‹©å›¾ç‰‡å’Œè§†é¢‘æ–‡ä»¶')
          return
        }

        this.submitting = true

        // å‡†å¤‡æäº¤æ•°æ®
        const formData = new FormData()

        // æ·»åŠ è¡¨å•å­—æ®µ
        formData.append('categoryId', this.caseData.categoryId)
        formData.append('title', this.caseData.title)
        formData.append('content', this.caseData.content || '')
        formData.append('tags', this.tagList.join(',')) // è½¬æ¢ä¸ºé€—å·åˆ†éš”å­—ç¬¦ä¸²
        formData.append('status', this.caseData.status)
        formData.append('showStatus', this.caseData.showStatus)

        // æ·»åŠ æ–‡ä»¶ï¼ˆå¦‚æœæœ‰é€‰æ‹©ï¼‰
        if (this.imageFile) {
          formData.append('imageFile', this.imageFile)
        }
        if (this.videoFile) {
          formData.append('videoFile', this.videoFile)
        }

        // æäº¤åˆ°åç«¯
        if (this.isEdit) {
          formData.append('id', this.caseData.id)
          await this.updateCase(formData)
        } else {
          await this.createCase(formData)
        }

        this.$message.success(this.isEdit ? 'æ›´æ–°æˆåŠŸ' : 'åˆ›å»ºæˆåŠŸ')
        this.$emit('success')

      } catch (error) {
        console.error('æäº¤å¤±è´¥:', error)
        this.$message.error('æäº¤å¤±è´¥')
      } finally {
        this.submitting = false
      }
    },

    // åˆ›å»ºæ¡ˆä¾‹
    async createCase(formData) {
      const response = await this.$http.post('/admin/case/create', formData, {
        headers: { 'Content-Type': 'multipart/form-data' }
      })
      return response.data
    },

    // æ›´æ–°æ¡ˆä¾‹
    async updateCase(formData) {
      const response = await this.$http.post(`/admin/case/update/${this.caseData.id}`, formData, {
        headers: { 'Content-Type': 'multipart/form-data' }
      })
      return response.data
    },

    // åŠ è½½æ¡ˆä¾‹æ•°æ®ï¼ˆç¼–è¾‘æ—¶ä½¿ç”¨ï¼‰
    async loadCaseData() {
      if (this.isEdit && this.caseId) {
        try {
          const response = await this.$http.get(`/admin/case/${this.caseId}`)
          const data = response.data.data

          this.caseData = {
            id: data.id,
            categoryId: data.categoryId,
            title: data.title,
            content: data.content,
            image: data.image,
            video: data.video,
            tags: data.tags,
            status: data.status,
            showStatus: data.showStatus
          }

          // å¤„ç†æ ‡ç­¾
          if (data.tags) {
            this.tagList = data.tags.split(',').filter(tag => tag.trim())
          }

        } catch (error) {
          console.error('åŠ è½½æ¡ˆä¾‹æ•°æ®å¤±è´¥:', error)
          this.$message.error('åŠ è½½æ•°æ®å¤±è´¥')
        }
      }
    },

    buildUrl(objectName) {
      if (!objectName) return ''
      if (objectName.startsWith('http')) return objectName
      return `${process.env.VUE_APP_STORAGE_BASE_URL}/${objectName}`
    }
  },

  async created() {
    await this.loadCaseData()
  }
}
</script>
```

**å…³é”®ä¿®æ­£ç‚¹ï¼š**

1. **ä¸¥æ ¼å¯¹åº”CaseDataå®ä½“**ï¼š
   - ç§»é™¤äº†ä¸å­˜åœ¨çš„å­—æ®µï¼ˆmediaTypeã€coverImageç­‰ï¼‰
   - ä¿æŒä¸æ•°æ®åº“è¡¨å®Œå…¨ä¸€è‡´çš„å­—æ®µç»“æ„

2. **æœ¬åœ°æ–‡ä»¶æš‚å­˜**ï¼š
   - å›¾ç‰‡/è§†é¢‘é€‰æ‹©åæš‚å­˜åœ¨æœ¬åœ°ï¼ˆimageFileã€videoFileï¼‰
   - ç”Ÿæˆé¢„è§ˆURLä¾›ç”¨æˆ·æŸ¥çœ‹
   - ç‚¹å‡»æäº¤æ—¶æ‰ä¸Šä¼ åˆ°åç«¯

3. **æ ‡ç­¾å¤„ç†**ï¼š
   - å‰ç«¯ä½¿ç”¨æ•°ç»„ç¼–è¾‘ï¼ˆtagListï¼‰
   - æäº¤æ—¶è½¬æ¢ä¸ºé€—å·åˆ†éš”å­—ç¬¦ä¸²ï¼ˆtagsï¼‰

4. **ç®€åŒ–ä¸šåŠ¡é€»è¾‘**ï¼š
   - æ¯ä¸ªæ¡ˆä¾‹å›ºå®šä¸ºï¼šä¸€å¼ å›¾ç‰‡ + ä¸€ä¸ªè§†é¢‘
   - å›¾ç‰‡ç”¨äºåˆ—è¡¨å±•ç¤ºï¼Œè§†é¢‘ç”¨äºé¢„è§ˆæ’­æ”¾
   - æ— éœ€å¤æ‚çš„åª’ä½“ç±»å‹åˆ¤æ–­

**ä¿®æ”¹æ–‡ä»¶**:
- `CaseDataDetail.vue` - æ ¸å¿ƒç¼–è¾‘ç»„ä»¶
- `components/MediaUpload.vue` - æ–°å»ºç»Ÿä¸€åª’ä½“ä¸Šä¼ ç»„ä»¶
- `components/MultiMediaUpload.vue` - æ–°å»ºå¤šæ–‡ä»¶ä¸Šä¼ ç»„ä»¶

### 1.3 åˆ—è¡¨å’Œè¯¦æƒ…é¡µé¢æ”¹é€  (ä¼˜å…ˆçº§: ä¸­)

**1.3.1 åˆ—è¡¨é¡µé¢å¢å¼º**

```vue
<!-- ä¿®æ”¹: index.vue -->
<el-table-column label="æ¡ˆä¾‹é¢„è§ˆ" width="150" align="center">
  <template slot-scope="scope">
    <div class="case-preview">
      <!-- è§†é¢‘ç±»å‹ -->
      <div v-if="scope.row.mediaType === 'video'" class="video-preview">
        <el-image
          style="width: 80px; height: 60px"
          :src="buildUrl(scope.row.image)"
          :preview-src-list="[buildUrl(scope.row.image)]"
          fit="cover">
        </el-image>
        <i class="video-icon">â–¶</i>
      </div>

      <!-- å›¾ç‰‡ç±»å‹ -->
      <div v-else-if="scope.row.mediaType === 'image'" class="image-preview">
        <el-image
          style="width: 80px; height: 60px"
          :src="buildUrl(scope.row.image)"
          :preview-src-list="scope.row.imageList.map(img => buildUrl(img))"
          fit="cover">
        </el-image>
        <span class="image-count" v-if="scope.row.imageList.length > 1">
          +{{ scope.row.imageList.length - 1 }}
        </span>
      </div>

      <!-- å›¾æ–‡æ··åˆ -->
      <div v-else class="mixed-preview">
        <div class="mixed-icon">ğŸ“„</div>
        <span>å›¾æ–‡</span>
      </div>
    </div>
  </template>
</el-table-column>

<el-table-column label="åª’ä½“ç±»å‹" width="100" align="center">
  <template slot-scope="scope">
    <el-tag :type="getMediaTypeTag(scope.row.mediaType)">
      {{ getMediaTypeLabel(scope.row.mediaType) }}
    </el-tag>
  </template>
</el-table-column>
```

**1.3.2 è¯¦æƒ…é¡µé¢å¢å¼º**

```vue
<!-- ä¿®æ”¹: detail.vue -->
<div class="case-detail">
  <!-- è§†é¢‘ç±»å‹å±•ç¤º -->
  <div v-if="caseData.mediaType === 'video'" class="video-section">
    <h3>æ¡ˆä¾‹è§†é¢‘</h3>
    <video
      v-if="caseData.video"
      :poster="buildUrl(caseData.image)"
      controls
      style="width: 100%; max-width: 800px; height: auto;">
      <source :src="buildUrl(caseData.video)" type="video/mp4">
      æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
    </video>
  </div>

  <!-- å›¾ç‰‡ç±»å‹å±•ç¤º -->
  <div v-else-if="caseData.mediaType === 'image'" class="image-section">
    <h3>æ¡ˆä¾‹å›¾ç‰‡</h3>
    <div class="image-gallery">
      <el-image
        v-for="(image, index) in caseData.imageList"
        :key="index"
        style="width: 200px; height: 150px; margin: 10px"
        :src="buildUrl(image)"
        :preview-src-list="caseData.imageList.map(img => buildUrl(img))"
        fit="cover">
      </el-image>
    </div>
  </div>

  <!-- å›¾æ–‡æ··åˆå±•ç¤º -->
  <div v-else-if="caseData.mediaType === 'mixed'" class="mixed-section">
    <h3>æ¡ˆä¾‹å†…å®¹</h3>
    <div class="rich-content" v-html="caseData.content"></div>
  </div>
</div>
```

## ç¬¬äºŒé˜¶æ®µï¼šç”¨æˆ·å‰ç«¯æ”¹é€ 

### 2.1 ReduxçŠ¶æ€ç®¡ç†ä¼˜åŒ– (ä¼˜å…ˆçº§: é«˜)

**ç›®æ ‡**: ä¿®æ­£æ¡ˆä¾‹æ•°æ®ç»“æ„ï¼Œä¸¥æ ¼å¯¹åº”CaseDataå®ä½“

**ä¿®æ”¹æ–‡ä»¶**: `src/store/aiSlice.ts`

```typescript
// ä¿®æ­£çš„æ¡ˆä¾‹æ•°æ®æ¥å£ - ä¸¥æ ¼å¯¹åº”åç«¯CaseDataå®ä½“
interface AICase {
  id: string;
  title: string;
  content: string;
  categoryId: number;
  category: string;         // åˆ†ç±»åç§°ï¼ˆå‰ç«¯æ˜¾ç¤ºç”¨ï¼‰

  // åª’ä½“æ–‡ä»¶å­—æ®µï¼ˆå¯¹åº”CaseDataå®ä½“ï¼‰
  image: string;           // å›¾ç‰‡ObjectName
  video: string;           // è§†é¢‘ObjectName
  tags: string;            // æ ‡ç­¾å­—ç¬¦ä¸²ï¼Œé€—å·åˆ†éš”

  // æ˜¾ç¤ºç”¨å®Œæ•´URL (å‰ç«¯computed)
  imageUrl?: string;       // å›¾ç‰‡å®Œæ•´URL
  videoUrl?: string;       // è§†é¢‘å®Œæ•´URL
  tagList?: string[];      // æ ‡ç­¾æ•°ç»„ï¼ˆå‰ç«¯æ˜¾ç¤ºç”¨ï¼‰

  // ç³»ç»Ÿå­—æ®µ
  status: number;          // çŠ¶æ€ï¼š0ç¦ç”¨ï¼Œ1å¯ç”¨
  showStatus: number;      // æ˜¾ç¤ºçŠ¶æ€ï¼š0ä¸æ˜¾ç¤ºï¼Œ1æ˜¾ç¤º
  viewCount: number;       // æµè§ˆæ•°
  likeCount: number;       // ç‚¹èµæ•°
  hotScore: number;        // çƒ­åº¦åˆ†æ•°
  createTime: string;
  updateTime: string;
}

// æ¡ˆä¾‹æ•°æ®è½¬æ¢å‡½æ•° - ä¿®æ­£ç‰ˆ
const transformCaseData = (item: any): AICase => {
  const buildUrl = (objectName: string) => {
    if (!objectName) return '';
    if (objectName.startsWith('http')) return objectName;
    return `${import.meta.env.VITE_STORAGE_BASE_URL}/${objectName}`;
  };

  return {
    id: item.id,
    title: item.title,
    content: item.content || '',
    categoryId: item.categoryId,
    category: item.categoryName || 'é»˜è®¤åˆ†ç±»',

    // åª’ä½“æ–‡ä»¶å­—æ®µï¼ˆä¸¥æ ¼å¯¹åº”CaseDataï¼‰
    image: item.image || '',           // å›¾ç‰‡ObjectName
    video: item.video || '',           // è§†é¢‘ObjectName
    tags: item.tags || '',             // æ ‡ç­¾å­—ç¬¦ä¸²

    // å‰ç«¯æ˜¾ç¤ºç”¨URL
    imageUrl: buildUrl(item.image || ''),
    videoUrl: buildUrl(item.video || ''),
    tagList: item.tags ? item.tags.split(',').filter(t => t.trim()) : [],

    // ç³»ç»Ÿå­—æ®µ
    status: item.status || 1,
    showStatus: item.showStatus || 1,
    viewCount: item.viewCount || 0,
    likeCount: item.likeCount || 0,
    hotScore: item.hotScore || 0,
    createTime: item.createTime || new Date().toISOString(),
    updateTime: item.updateTime || new Date().toISOString()
  };
};

// å¼‚æ­¥actionæ›´æ–°
export const fetchCases = createAsyncThunk(
  'ai/fetchCases',
  async (params: { category?: string; page?: number; size?: number }) => {
    try {
      const response = await fetch('/api/cases', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(params)
      });

      const result = await response.json();

      if (result.code === 200) {
        return {
          cases: result.data.list.map(transformCaseData),
          total: result.data.total
        };
      } else {
        throw new Error(result.message || 'è·å–æ¡ˆä¾‹å¤±è´¥');
      }
    } catch (error) {
      // é™çº§ç­–ç•¥ï¼šä½¿ç”¨æœ¬åœ°æ•°æ®
      console.warn('APIè°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®:', error);
      const { galleryData } = await import('../data/galleryData');
      return {
        cases: galleryData.map(transformCaseData),
        total: galleryData.length
      };
    }
  }
);
```

### 2.2 æ¡ˆä¾‹å±•ç¤ºç»„ä»¶æ”¹é€  (ä¼˜å…ˆçº§: é«˜)

**ç›®æ ‡**: æ”¯æŒè§†é¢‘æ’­æ”¾ã€å¤šå›¾å±•ç¤ºã€å›¾æ–‡æ··åˆ

**2.2.1 åˆ›å»ºåª’ä½“å±•ç¤ºç»„ä»¶**

```tsx
// æ–°ç»„ä»¶: src/components/MediaDisplay.tsx
import React, { useState, useRef } from 'react';
import { AICase } from '../types';

interface MediaDisplayProps {
  caseData: AICase;
  className?: string;
  autoPlay?: boolean;
  showControls?: boolean;
  showVideo?: boolean;  // æ˜¯å¦æ˜¾ç¤ºè§†é¢‘ï¼ˆtrueï¼‰è¿˜æ˜¯å›¾ç‰‡ï¼ˆfalseï¼‰
}

const MediaDisplay: React.FC<MediaDisplayProps> = ({
  caseData,
  className = '',
  autoPlay = false,
  showControls = true,
  showVideo = false
}) => {
  const [isVideoLoaded, setIsVideoLoaded] = useState(false);
  const videoRef = useRef<HTMLVideoElement>(null);

  const handleVideoLoad = () => {
    setIsVideoLoaded(true);
  };

  // ç®€åŒ–çš„åª’ä½“å±•ç¤º - æ¯ä¸ªæ¡ˆä¾‹éƒ½æœ‰å›¾ç‰‡å’Œè§†é¢‘
  return (
    <div className={`media-display ${className}`}>
      {/* æ ¹æ®æ˜¾ç¤ºæ¨¡å¼å†³å®šå±•ç¤ºå†…å®¹ */}
      {showVideo && caseData.videoUrl ? (
        // è§†é¢‘æ’­æ”¾æ¨¡å¼
        <div className="video-container">
          <video
            ref={videoRef}
            poster={caseData.imageUrl} // ä½¿ç”¨å›¾ç‰‡ä½œä¸ºè§†é¢‘å°é¢
            controls={showControls}
            autoPlay={autoPlay}
            muted={autoPlay}
            onLoadedData={handleVideoLoad}
            style={{
              width: '100%',
              height: 'auto',
              borderRadius: '8px'
            }}
          >
            <source src={caseData.videoUrl} type="video/mp4" />
            æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
          </video>

          {!isVideoLoaded && (
            <div className="video-loading">
              <div className="loading-spinner"></div>
              <span>è§†é¢‘åŠ è½½ä¸­...</span>
            </div>
          )}
        </div>
      ) : (
        // å›¾ç‰‡æ˜¾ç¤ºæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
        <div className="image-container">
          <img
            src={caseData.imageUrl}
            alt={caseData.title}
            style={{
              width: '100%',
              height: 'auto',
              borderRadius: '8px'
            }}
            loading="lazy"
          />

          {/* è§†é¢‘æ’­æ”¾å›¾æ ‡ */}
          {caseData.videoUrl && (
            <div className="play-button-overlay">
              <div className="play-icon">â–¶</div>
            </div>
          )}
        </div>
      )}
    </div>
  );
};

export default MediaDisplay;
```

**2.2.2 æ¡ˆä¾‹å¡ç‰‡ç»„ä»¶æ”¹é€ **

```tsx
// ä¿®æ”¹: src/components/CaseCard.tsx
import React, { useState } from 'react';
import MediaDisplay from './MediaDisplay';
import { AICase } from '../types';

interface CaseCardProps {
  caseData: AICase;
  onClick?: () => void;
}

const CaseCard: React.FC<CaseCardProps> = ({ caseData, onClick }) => {
  const [isHovered, setIsHovered] = useState(false);

  const handleCardClick = () => {
    onClick?.();
  };

  const getMediaTypeIcon = () => {
    switch (caseData.mediaType) {
      case 'video':
        return 'ğŸ¬';
      case 'image':
        return 'ğŸ–¼ï¸';
      case 'mixed':
        return 'ğŸ“„';
      default:
        return 'ğŸ“';
    }
  };

  const getImageCount = () => {
    if (caseData.mediaType === 'image' && caseData.imageListUrls) {
      return caseData.imageListUrls.length;
    }
    return 0;
  };

  return (
    <div
      className="case-card"
      onClick={handleCardClick}
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
      style={{
        cursor: 'pointer',
        borderRadius: '12px',
        overflow: 'hidden',
        backgroundColor: '#fff',
        boxShadow: isHovered
          ? '0 8px 25px rgba(0, 0, 0, 0.15)'
          : '0 2px 10px rgba(0, 0, 0, 0.1)',
        transform: isHovered ? 'translateY(-2px)' : 'translateY(0)',
        transition: 'all 0.3s ease',
        marginBottom: '20px',
        breakInside: 'avoid'  // é˜²æ­¢ç€‘å¸ƒæµæ–­è£‚
      }}
    >
      {/* åª’ä½“å±•ç¤ºåŒºåŸŸ */}
      <div className="media-section">
        <MediaDisplay
          caseData={caseData}
          autoPlay={isHovered && caseData.mediaType === 'video'} // æ‚¬åœè‡ªåŠ¨æ’­æ”¾è§†é¢‘
          showControls={false} // å¡ç‰‡ä¸­ä¸æ˜¾ç¤ºæ§åˆ¶æ¡
        />

        {/* åª’ä½“ç±»å‹æ ‡è¯† */}
        <div className="media-type-badge">
          {getMediaTypeIcon()}
          {caseData.mediaType === 'image' && getImageCount() > 1 && (
            <span className="image-count">+{getImageCount() - 1}</span>
          )}
        </div>

        {/* è§†é¢‘æ’­æ”¾æŒ‰é’® */}
        {caseData.mediaType === 'video' && !isHovered && (
          <div className="play-button">
            <div className="play-icon">â–¶</div>
          </div>
        )}
      </div>

      {/* å†…å®¹åŒºåŸŸ */}
      <div className="content-section" style={{ padding: '16px' }}>
        <h3
          style={{
            margin: '0 0 8px 0',
            fontSize: '16px',
            fontWeight: '600',
            color: '#1a1a1a',
            lineHeight: '1.4'
          }}
        >
          {caseData.title}
        </h3>

        {caseData.description && (
          <p
            style={{
              margin: '0 0 12px 0',
              fontSize: '14px',
              color: '#666',
              lineHeight: '1.5',
              display: '-webkit-box',
              WebkitLineClamp: 2,
              WebkitBoxOrient: 'vertical',
              overflow: 'hidden'
            }}
          >
            {caseData.description}
          </p>
        )}

        {/* æ ‡ç­¾ */}
        {caseData.tagList && caseData.tagList.length > 0 && (
          <div className="tags" style={{ marginBottom: '12px' }}>
            {caseData.tagList.slice(0, 3).map((tag, index) => (
              <span
                key={index}
                style={{
                  display: 'inline-block',
                  padding: '4px 8px',
                  margin: '0 6px 6px 0',
                  fontSize: '12px',
                  backgroundColor: '#f0f0f0',
                  color: '#666',
                  borderRadius: '12px'
                }}
              >
                {tag}
              </span>
            ))}
          </div>
        )}

        {/* åº•éƒ¨ä¿¡æ¯ */}
        <div
          style={{
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            fontSize: '12px',
            color: '#999'
          }}
        >
          <span>{caseData.category}</span>
          <span>{new Date(caseData.createdAt).toLocaleDateString()}</span>
        </div>
      </div>
    </div>
  );
};

export default CaseCard;
```

### 2.3 æ¡ˆä¾‹è¯¦æƒ…å¼¹çª— (ä¼˜å…ˆçº§: ä¸­)

**ç›®æ ‡**: åˆ›å»ºå…¨å±æ¡ˆä¾‹è¯¦æƒ…æŸ¥çœ‹å™¨

```tsx
// æ–°ç»„ä»¶: src/components/CaseDetailModal.tsx
import React, { useEffect, useRef } from 'react';
import { createPortal } from 'react-dom';
import MediaDisplay from './MediaDisplay';
import { AICase } from '../types';

interface CaseDetailModalProps {
  caseData: AICase | null;
  isOpen: boolean;
  onClose: () => void;
}

const CaseDetailModal: React.FC<CaseDetailModalProps> = ({
  caseData,
  isOpen,
  onClose
}) => {
  const modalRef = useRef<HTMLDivElement>(null);

  // é”®ç›˜äº‹ä»¶å¤„ç†
  useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      if (event.key === 'Escape') {
        onClose();
      }
    };

    if (isOpen) {
      document.addEventListener('keydown', handleKeyDown);
      document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
    }

    return () => {
      document.removeEventListener('keydown', handleKeyDown);
      document.body.style.overflow = 'unset';
    };
  }, [isOpen, onClose]);

  // ç‚¹å‡»èƒŒæ™¯å…³é—­
  const handleBackdropClick = (event: React.MouseEvent) => {
    if (event.target === modalRef.current) {
      onClose();
    }
  };

  if (!isOpen || !caseData) return null;

  const modalContent = (
    <div
      ref={modalRef}
      className="case-detail-modal"
      onClick={handleBackdropClick}
      style={{
        position: 'fixed',
        top: 0,
        left: 0,
        right: 0,
        bottom: 0,
        backgroundColor: 'rgba(0, 0, 0, 0.9)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        zIndex: 1000,
        padding: '20px'
      }}
    >
      <div
        className="modal-content"
        style={{
          backgroundColor: '#fff',
          borderRadius: '12px',
          maxWidth: '90vw',
          maxHeight: '90vh',
          overflow: 'auto',
          position: 'relative'
        }}
      >
        {/* å…³é—­æŒ‰é’® */}
        <button
          onClick={onClose}
          className="close-button"
          style={{
            position: 'absolute',
            top: '16px',
            right: '16px',
            background: 'rgba(0, 0, 0, 0.5)',
            color: '#fff',
            border: 'none',
            borderRadius: '50%',
            width: '32px',
            height: '32px',
            cursor: 'pointer',
            zIndex: 1001,
            fontSize: '18px'
          }}
        >
          Ã—
        </button>

        {/* åª’ä½“å±•ç¤ºåŒºåŸŸ */}
        <div className="media-section">
          <MediaDisplay
            caseData={caseData}
            autoPlay={caseData.mediaType === 'video'}
            showControls={true}
          />
        </div>

        {/* è¯¦ç»†ä¿¡æ¯ */}
        <div style={{ padding: '24px' }}>
          <h1
            style={{
              margin: '0 0 16px 0',
              fontSize: '24px',
              fontWeight: '700',
              color: '#1a1a1a'
            }}
          >
            {caseData.title}
          </h1>

          {caseData.description && (
            <p
              style={{
                margin: '0 0 20px 0',
                fontSize: '16px',
                lineHeight: '1.6',
                color: '#444'
              }}
            >
              {caseData.description}
            </p>
          )}

          {/* æ ‡ç­¾ */}
          {caseData.tagList && caseData.tagList.length > 0 && (
            <div style={{ marginBottom: '20px' }}>
              <h3 style={{ margin: '0 0 12px 0', fontSize: '16px', color: '#666' }}>
                æ ‡ç­¾
              </h3>
              <div>
                {caseData.tagList.map((tag, index) => (
                  <span
                    key={index}
                    style={{
                      display: 'inline-block',
                      padding: '6px 12px',
                      margin: '0 8px 8px 0',
                      fontSize: '14px',
                      backgroundColor: '#e3f2fd',
                      color: '#1976d2',
                      borderRadius: '16px'
                    }}
                  >
                    {tag}
                  </span>
                ))}
              </div>
            </div>
          )}

          {/* å…ƒä¿¡æ¯ */}
          <div
            style={{
              display: 'grid',
              gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
              gap: '16px',
              padding: '16px',
              backgroundColor: '#f5f5f5',
              borderRadius: '8px'
            }}
          >
            <div>
              <strong>åˆ†ç±»ï¼š</strong>
              <span>{caseData.category}</span>
            </div>
            <div>
              <strong>ç±»å‹ï¼š</strong>
              <span>
                {caseData.mediaType === 'video' && 'è§†é¢‘'}
                {caseData.mediaType === 'image' && 'å›¾ç‰‡'}
                {caseData.mediaType === 'mixed' && 'å›¾æ–‡æ··åˆ'}
              </span>
            </div>
            <div>
              <strong>åˆ›å»ºæ—¶é—´ï¼š</strong>
              <span>{new Date(caseData.createdAt).toLocaleString()}</span>
            </div>
            {caseData.mediaType === 'image' && caseData.imageListUrls && (
              <div>
                <strong>å›¾ç‰‡æ•°é‡ï¼š</strong>
                <span>{caseData.imageListUrls.length} å¼ </span>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );

  return createPortal(modalContent, document.body);
};

export default CaseDetailModal;
```

### 2.4 Homeé¡µé¢é›†æˆ (ä¼˜å…ˆçº§: é«˜)

**ä¿®æ”¹æ–‡ä»¶**: `src/pages/Home.tsx`

```tsx
// ä¸»è¦ä¿®æ”¹ç‚¹
import CaseCard from '../components/CaseCard';
import CaseDetailModal from '../components/CaseDetailModal';

const Home: React.FC = () => {
  // æ·»åŠ è¯¦æƒ…å¼¹çª—çŠ¶æ€
  const [selectedCase, setSelectedCase] = useState<AICase | null>(null);
  const [showCaseDetail, setShowCaseDetail] = useState(false);

  // æ¡ˆä¾‹ç‚¹å‡»å¤„ç†
  const handleCaseClick = (caseData: AICase) => {
    setSelectedCase(caseData);
    setShowCaseDetail(true);
  };

  // æ¡ˆä¾‹å±•ç¤ºåŒºåŸŸæ”¹é€ 
  const renderCaseGallery = () => (
    <div
      style={{
        display: 'grid',
        gridTemplateColumns: `repeat(${galleryColumns}, 1fr)`,
        gap: '20px',
        padding: '20px 0'
      }}
    >
      {filteredCases.map((item) => (
        <CaseCard
          key={item.id}
          caseData={item}
          onClick={() => handleCaseClick(item)}
        />
      ))}
    </div>
  );

  return (
    <div className="home-page">
      {/* åŸæœ‰å†…å®¹ */}

      {/* æ¡ˆä¾‹å±•ç¤º */}
      {renderCaseGallery()}

      {/* æ¡ˆä¾‹è¯¦æƒ…å¼¹çª— */}
      <CaseDetailModal
        caseData={selectedCase}
        isOpen={showCaseDetail}
        onClose={() => {
          setShowCaseDetail(false);
          setSelectedCase(null);
        }}
      />
    </div>
  );
};
```

## ç¬¬ä¸‰é˜¶æ®µï¼šè”è°ƒå’Œä¼˜åŒ–

### 3.1 åç«¯è”è°ƒ (ä¼˜å…ˆçº§: é«˜)

**3.1.1 APIæ¥å£è”è°ƒæµ‹è¯•**

```java
// æµ‹è¯•ç”¨ä¾‹: CaseFileUploadIntegrationTest.java
@SpringBootTest
@TestMethodOrder(OrderAnnotation.class)
class CaseFileUploadIntegrationTest {

    @Autowired
    private TestRestTemplate restTemplate;

    @Autowired
    private FileStorageService fileStorageService;

    private String uploadedImageObjectName;
    private String uploadedVideoObjectName;

    @Test
    @Order(1)
    void testImageUpload() throws Exception {
        // æµ‹è¯•å›¾ç‰‡ä¸Šä¼ 
        MultiValueMap<String, Object> parts = new LinkedMultiValueMap<>();
        parts.add("file", new FileSystemResource("src/test/resources/images/test.jpg"));

        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.MULTIPART_FORM_DATA);

        HttpEntity<MultiValueMap<String, Object>> request = new HttpEntity<>(parts, headers);
        ResponseEntity<String> response = restTemplate.postForEntity(
            "/admin/case/upload", request, String.class);

        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);

        // è§£æå“åº”è·å–objectName
        JsonNode jsonResponse = objectMapper.readTree(response.getBody());
        uploadedImageObjectName = jsonResponse.get("data").get("objectName").asText();

        assertThat(uploadedImageObjectName).isNotEmpty();
    }

    @Test
    @Order(2)
    void testVideoUpload() throws Exception {
        // æµ‹è¯•è§†é¢‘ä¸Šä¼ 
        MultiValueMap<String, Object> parts = new LinkedMultiValueMap<>();
        parts.add("file", new FileSystemResource("src/test/resources/videos/test.mp4"));

        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.MULTIPART_FORM_DATA);

        HttpEntity<MultiValueMap<String, Object>> request = new HttpEntity<>(parts, headers);
        ResponseEntity<String> response = restTemplate.postForEntity(
            "/admin/case/upload", request, String.class);

        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);

        JsonNode jsonResponse = objectMapper.readTree(response.getBody());
        uploadedVideoObjectName = jsonResponse.get("data").get("objectName").asText();

        assertThat(uploadedVideoObjectName).isNotEmpty();
    }

    @Test
    @Order(3)
    void testCreateCaseWithMedia() throws Exception {
        // æµ‹è¯•åˆ›å»ºåŒ…å«åª’ä½“æ–‡ä»¶çš„æ¡ˆä¾‹
        CaseData caseData = new CaseData();
        caseData.setTitle("æµ‹è¯•æ¡ˆä¾‹");
        caseData.setCategoryId(1L);
        caseData.setMediaType("video");
        caseData.setImage(uploadedImageObjectName);  // å°é¢
        caseData.setVideo(uploadedVideoObjectName);  // è§†é¢‘
        caseData.setDescription("è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹");

        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_JSON);

        HttpEntity<CaseData> request = new HttpEntity<>(caseData, headers);
        ResponseEntity<String> response = restTemplate.postForEntity(
            "/admin/case/create", request, String.class);

        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
    }

    @Test
    @Order(4)
    void testCaseListWithMediaUrls() throws Exception {
        // æµ‹è¯•æ¡ˆä¾‹åˆ—è¡¨è¿”å›æ­£ç¡®çš„åª’ä½“URL
        ResponseEntity<String> response = restTemplate.getForEntity(
            "/admin/case/list?pageNum=1&pageSize=10", String.class);

        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);

        JsonNode jsonResponse = objectMapper.readTree(response.getBody());
        JsonNode caseList = jsonResponse.get("data").get("list");

        // éªŒè¯è¿”å›çš„æ•°æ®åŒ…å«æ­£ç¡®çš„åª’ä½“å­—æ®µ
        for (JsonNode caseItem : caseList) {
            if (caseItem.has("image")) {
                String imageObjectName = caseItem.get("image").asText();
                assertThat(imageObjectName).isNotEmpty();

                // éªŒè¯å¯ä»¥æ„å»ºè®¿é—®URL
                String imageUrl = fileStorageService.buildUrl(imageObjectName);
                assertThat(imageUrl).startsWith("http");
            }
        }
    }

    @AfterEach
    void cleanup() {
        // æ¸…ç†ä¸Šä¼ çš„æµ‹è¯•æ–‡ä»¶
        if (uploadedImageObjectName != null) {
            fileStorageService.deleteFile(uploadedImageObjectName);
        }
        if (uploadedVideoObjectName != null) {
            fileStorageService.deleteFile(uploadedVideoObjectName);
        }
    }
}
```

**3.1.2 å‰åç«¯æ•°æ®æ ¼å¼å¯¹æ¥**

```typescript
// å‰ç«¯APIå®¢æˆ·ç«¯: src/api/caseApi.ts
interface CaseUploadResponse {
  code: number;
  message: string;
  data: {
    objectName: string;
    url: string;
    fileName: string;
    fileSize: number;
    contentType: string;
  };
}

interface CaseListResponse {
  code: number;
  message: string;
  data: {
    list: CaseItem[];
    total: number;
    page: number;
    size: number;
  };
}

interface CaseItem {
  id: string;
  title: string;
  categoryId: number;
  categoryName: string;
  mediaType: 'image' | 'video' | 'mixed';
  image: string;          // objectName
  video: string;          // objectName
  imageList: string[];    // objectName[]
  content: string;
  description: string;
  tagList: string[];
  status: number;
  createdAt: string;
}

export const caseApi = {
  // æ–‡ä»¶ä¸Šä¼ 
  uploadFile: async (file: File): Promise<CaseUploadResponse> => {
    const formData = new FormData();
    formData.append('file', file);

    const response = await fetch('/admin/case/upload', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${getToken()}`
      },
      body: formData
    });

    return response.json();
  },

  // è·å–æ¡ˆä¾‹åˆ—è¡¨
  getCaseList: async (params: {
    pageNum?: number;
    pageSize?: number;
    categoryId?: number;
    keyword?: string;
  }): Promise<CaseListResponse> => {
    const queryString = new URLSearchParams({
      pageNum: String(params.pageNum || 1),
      pageSize: String(params.pageSize || 20),
      ...(params.categoryId && { categoryId: String(params.categoryId) }),
      ...(params.keyword && { keyword: params.keyword })
    });

    const response = await fetch(`/admin/case/list?${queryString}`, {
      headers: {
        'Authorization': `Bearer ${getToken()}`
      }
    });

    return response.json();
  },

  // åˆ›å»ºæ¡ˆä¾‹
  createCase: async (caseData: Partial<CaseItem>): Promise<{ code: number; message: string }> => {
    const response = await fetch('/admin/case/create', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${getToken()}`
      },
      body: JSON.stringify(caseData)
    });

    return response.json();
  }
};

// å·¥å…·å‡½æ•°ï¼šæ„å»ºåª’ä½“æ–‡ä»¶å®Œæ•´URL
export const buildMediaUrl = (objectName: string): string => {
  if (!objectName) return '';
  if (objectName.startsWith('http://') || objectName.startsWith('https://')) {
    return objectName;
  }

  const baseUrl = import.meta.env.VITE_STORAGE_BASE_URL || 'http://localhost:9090/test-mall';
  return `${baseUrl}/${objectName}`;
};
```

### 3.2 æ€§èƒ½ä¼˜åŒ– (ä¼˜å…ˆçº§: ä¸­)

**3.2.1 å›¾ç‰‡æ‡’åŠ è½½ä¼˜åŒ–**

```tsx
// src/hooks/useIntersectionObserver.ts
import { useEffect, useRef, useState } from 'react';

export const useIntersectionObserver = (
  options: IntersectionObserverInit = {}
) => {
  const [isIntersecting, setIsIntersecting] = useState(false);
  const targetRef = useRef<HTMLElement>(null);

  useEffect(() => {
    const target = targetRef.current;
    if (!target) return;

    const observer = new IntersectionObserver(([entry]) => {
      setIsIntersecting(entry.isIntersecting);
    }, {
      threshold: 0.1,
      rootMargin: '50px',
      ...options
    });

    observer.observe(target);

    return () => {
      observer.unobserve(target);
    };
  }, [options]);

  return { targetRef, isIntersecting };
};

// æ‡’åŠ è½½å›¾ç‰‡ç»„ä»¶
import React from 'react';
import { useIntersectionObserver } from '../hooks/useIntersectionObserver';

interface LazyImageProps {
  src: string;
  alt: string;
  placeholder?: string;
  className?: string;
  style?: React.CSSProperties;
}

const LazyImage: React.FC<LazyImageProps> = ({
  src,
  alt,
  placeholder = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PC9zdmc+',
  className,
  style
}) => {
  const { targetRef, isIntersecting } = useIntersectionObserver();
  const [imageLoaded, setImageLoaded] = useState(false);
  const [imageError, setImageError] = useState(false);

  const handleImageLoad = () => {
    setImageLoaded(true);
  };

  const handleImageError = () => {
    setImageError(true);
  };

  return (
    <div ref={targetRef} className={className} style={style}>
      {isIntersecting && (
        <img
          src={imageError ? placeholder : src}
          alt={alt}
          onLoad={handleImageLoad}
          onError={handleImageError}
          style={{
            width: '100%',
            height: '100%',
            objectFit: 'cover',
            opacity: imageLoaded ? 1 : 0,
            transition: 'opacity 0.3s ease'
          }}
        />
      )}

      {!isIntersecting && (
        <img
          src={placeholder}
          alt="Loading..."
          style={{
            width: '100%',
            height: '100%',
            objectFit: 'cover'
          }}
        />
      )}
    </div>
  );
};

export default LazyImage;
```

**3.2.2 è§†é¢‘é¢„åŠ è½½ç­–ç•¥**

```tsx
// src/components/LazyVideo.tsx
import React, { useState, useRef, useEffect } from 'react';
import { useIntersectionObserver } from '../hooks/useIntersectionObserver';

interface LazyVideoProps {
  src: string;
  poster?: string;
  autoPlay?: boolean;
  muted?: boolean;
  controls?: boolean;
  className?: string;
  style?: React.CSSProperties;
}

const LazyVideo: React.FC<LazyVideoProps> = ({
  src,
  poster,
  autoPlay = false,
  muted = true,
  controls = true,
  className,
  style
}) => {
  const { targetRef, isIntersecting } = useIntersectionObserver({
    threshold: 0.3  // 30%å¯è§æ—¶å¼€å§‹åŠ è½½
  });

  const videoRef = useRef<HTMLVideoElement>(null);
  const [isLoaded, setIsLoaded] = useState(false);
  const [shouldLoad, setShouldLoad] = useState(false);

  useEffect(() => {
    if (isIntersecting && !shouldLoad) {
      setShouldLoad(true);
    }
  }, [isIntersecting, shouldLoad]);

  const handleLoadedData = () => {
    setIsLoaded(true);
  };

  return (
    <div ref={targetRef} className={className} style={style}>
      {shouldLoad ? (
        <video
          ref={videoRef}
          src={src}
          poster={poster}
          autoPlay={autoPlay && isIntersecting}
          muted={muted}
          controls={controls}
          preload="metadata"
          onLoadedData={handleLoadedData}
          style={{
            width: '100%',
            height: '100%',
            objectFit: 'cover'
          }}
        >
          æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
        </video>
      ) : (
        // æ˜¾ç¤ºå°é¢å›¾ç‰‡ä½œä¸ºå ä½ç¬¦
        <img
          src={poster}
          alt="Video thumbnail"
          style={{
            width: '100%',
            height: '100%',
            objectFit: 'cover'
          }}
        />
      )}

      {/* åŠ è½½æŒ‡ç¤ºå™¨ */}
      {shouldLoad && !isLoaded && (
        <div
          style={{
            position: 'absolute',
            top: '50%',
            left: '50%',
            transform: 'translate(-50%, -50%)',
            color: '#fff',
            backgroundColor: 'rgba(0, 0, 0, 0.5)',
            padding: '8px 16px',
            borderRadius: '4px'
          }}
        >
          è§†é¢‘åŠ è½½ä¸­...
        </div>
      )}
    </div>
  );
};

export default LazyVideo;
```

### 3.3 é”™è¯¯å¤„ç†å’Œå®¹é”™ (ä¼˜å…ˆçº§: ä¸­)

**3.3.1 æ–‡ä»¶ä¸Šä¼ é”™è¯¯å¤„ç†**

```tsx
// src/components/MediaUpload.tsx é”™è¯¯å¤„ç†å¢å¼º
const MediaUpload: React.FC<MediaUploadProps> = ({ ... }) => {
  const [uploadError, setUploadError] = useState<string>('');
  const [retryCount, setRetryCount] = useState(0);
  const maxRetries = 3;

  const handleUploadError = async (error: any) => {
    console.error('ä¸Šä¼ é”™è¯¯:', error);

    if (retryCount < maxRetries) {
      setUploadError(`ä¸Šä¼ å¤±è´¥ï¼Œæ­£åœ¨é‡è¯• (${retryCount + 1}/${maxRetries})...`);
      setRetryCount(prev => prev + 1);

      // å»¶è¿Ÿåé‡è¯•
      setTimeout(() => {
        // é‡æ–°è§¦å‘ä¸Šä¼ 
        handleRetryUpload();
      }, 2000);
    } else {
      setUploadError('ä¸Šä¼ å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–æ–‡ä»¶æ ¼å¼');
      setRetryCount(0);
    }
  };

  const handleRetryUpload = () => {
    // å®ç°é‡è¯•é€»è¾‘
    if (lastUploadFile) {
      uploadFile(lastUploadFile);
    }
  };

  // ç½‘ç»œçŠ¶æ€æ£€æµ‹
  const [isOnline, setIsOnline] = useState(navigator.onLine);

  useEffect(() => {
    const handleOnline = () => setIsOnline(true);
    const handleOffline = () => setIsOnline(false);

    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);

    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  // é”™è¯¯æ˜¾ç¤ºç»„ä»¶
  const renderError = () => {
    if (!uploadError) return null;

    return (
      <div style={{
        padding: '12px',
        backgroundColor: '#fff3cd',
        border: '1px solid #ffeaa7',
        borderRadius: '4px',
        marginTop: '8px'
      }}>
        <div style={{ color: '#856404', fontSize: '14px' }}>
          {uploadError}
        </div>
        {!isOnline && (
          <div style={{ color: '#dc3545', fontSize: '12px', marginTop: '4px' }}>
            æ£€æµ‹åˆ°ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•
          </div>
        )}
        {retryCount >= maxRetries && (
          <button
            onClick={() => {
              setUploadError('');
              setRetryCount(0);
            }}
            style={{
              marginTop: '8px',
              padding: '4px 12px',
              backgroundColor: '#007bff',
              color: '#fff',
              border: 'none',
              borderRadius: '4px',
              cursor: 'pointer'
            }}
          >
            é‡æ–°ä¸Šä¼ 
          </button>
        )}
      </div>
    );
  };

  return (
    <div>
      {/* åŸæœ‰ä¸Šä¼ ç»„ä»¶ */}
      {renderError()}
    </div>
  );
};
```

**3.3.2 APIé™çº§ç­–ç•¥**

```typescript
// src/utils/apiWithFallback.ts
interface FallbackOptions {
  maxRetries: number;
  retryDelay: number;
  fallbackData?: any;
  useLocalStorage?: boolean;
}

export const apiWithFallback = async <T>(
  apiCall: () => Promise<T>,
  fallbackCall?: () => Promise<T> | T,
  options: Partial<FallbackOptions> = {}
): Promise<T> => {
  const {
    maxRetries = 3,
    retryDelay = 1000,
    fallbackData,
    useLocalStorage = true
  } = options;

  for (let i = 0; i <= maxRetries; i++) {
    try {
      const result = await apiCall();

      // æˆåŠŸæ—¶ç¼“å­˜åˆ°æœ¬åœ°å­˜å‚¨
      if (useLocalStorage && result) {
        const cacheKey = apiCall.toString().slice(0, 50);
        localStorage.setItem(`api_cache_${cacheKey}`, JSON.stringify({
          data: result,
          timestamp: Date.now()
        }));
      }

      return result;
    } catch (error) {
      console.warn(`APIè°ƒç”¨å¤±è´¥ (ç¬¬${i + 1}æ¬¡)`, error);

      if (i < maxRetries) {
        await new Promise(resolve => setTimeout(resolve, retryDelay * (i + 1)));
        continue;
      }

      // æœ€åä¸€æ¬¡é‡è¯•å¤±è´¥ï¼Œå°è¯•fallback
      if (fallbackCall) {
        try {
          console.log('ä½¿ç”¨fallbackæ•°æ®');
          return await Promise.resolve(fallbackCall());
        } catch (fallbackError) {
          console.error('Fallbackä¹Ÿå¤±è´¥äº†', fallbackError);
        }
      }

      // å°è¯•ä»æœ¬åœ°ç¼“å­˜è·å–
      if (useLocalStorage) {
        try {
          const cacheKey = apiCall.toString().slice(0, 50);
          const cached = localStorage.getItem(`api_cache_${cacheKey}`);
          if (cached) {
            const { data, timestamp } = JSON.parse(cached);
            // ç¼“å­˜ä¸è¶…è¿‡1å°æ—¶
            if (Date.now() - timestamp < 3600000) {
              console.log('ä½¿ç”¨ç¼“å­˜æ•°æ®');
              return data;
            }
          }
        } catch (cacheError) {
          console.error('è¯»å–ç¼“å­˜å¤±è´¥', cacheError);
        }
      }

      // ä½¿ç”¨é»˜è®¤fallbackæ•°æ®
      if (fallbackData !== undefined) {
        console.log('ä½¿ç”¨é»˜è®¤fallbackæ•°æ®');
        return fallbackData;
      }

      throw error;
    }
  }

  throw new Error('APIè°ƒç”¨å’Œæ‰€æœ‰fallbackéƒ½å¤±è´¥äº†');
};

// ä½¿ç”¨ç¤ºä¾‹
export const fetchCasesWithFallback = (params: any) => {
  return apiWithFallback(
    () => caseApi.getCaseList(params),
    () => import('../data/galleryData').then(module => ({
      code: 200,
      data: {
        list: module.galleryData,
        total: module.galleryData.length
      }
    })),
    {
      maxRetries: 2,
      retryDelay: 1000,
      useLocalStorage: true
    }
  );
};
```

## å®æ–½è®¡åˆ’å’Œæ—¶é—´å®‰æ’

### é˜¶æ®µä¸€ï¼šåŸºç¡€æ”¹é€  (é¢„è®¡3-5å¤©)
1. **Day 1**: åç«¯APIå¼€å‘å’Œæµ‹è¯•
   - å®ç°FileStorageServiceç»Ÿä¸€ä¸Šä¼ æ¥å£
   - ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

2. **Day 2-3**: ç®¡ç†åç«¯å‰ç«¯æ”¹é€ 
   - å¼€å‘MediaUploadç­‰ä¸Šä¼ ç»„ä»¶
   - æ”¹é€ CaseDataDetailç¼–è¾‘ç»„ä»¶
   - æ›´æ–°åˆ—è¡¨å’Œè¯¦æƒ…é¡µé¢

3. **Day 4-5**: åŸºç¡€è”è°ƒæµ‹è¯•
   - å‰åç«¯æ¥å£è”è°ƒ
   - åŸºæœ¬åŠŸèƒ½æµ‹è¯•
   - æ•°æ®æ ¼å¼éªŒè¯

### é˜¶æ®µäºŒï¼šç”¨æˆ·å‰ç«¯æ”¹é€  (é¢„è®¡2-3å¤©)
1. **Day 6**: Reduxå’ŒAPIå±‚æ”¹é€ 
   - æ›´æ–°æ•°æ®ç»“æ„å’ŒAPIè°ƒç”¨
   - å®ç°URLæ„å»ºå·¥å…·å‡½æ•°

2. **Day 7-8**: ç»„ä»¶å¼€å‘å’Œé›†æˆ
   - å¼€å‘MediaDisplayç»„ä»¶
   - æ”¹é€ CaseCardå’Œè¯¦æƒ…å¼¹çª—
   - é›†æˆåˆ°Homeé¡µé¢

### é˜¶æ®µä¸‰ï¼šä¼˜åŒ–å’Œæµ‹è¯• (é¢„è®¡2-3å¤©)
1. **Day 9**: æ€§èƒ½ä¼˜åŒ–
   - æ‡’åŠ è½½å®ç°
   - é”™è¯¯å¤„ç†å¢å¼º

2. **Day 10-11**: å…¨é¢æµ‹è¯•å’Œè°ƒä¼˜
   - ç«¯åˆ°ç«¯æµ‹è¯•
   - æ€§èƒ½æµ‹è¯•
   - ç”¨æˆ·ä½“éªŒä¼˜åŒ–

## é£é™©è¯„ä¼°å’Œåº”å¯¹

### é«˜é£é™©ç‚¹
1. **æ•°æ®è¿ç§»é£é™©**: ç°æœ‰æ¡ˆä¾‹æ•°æ®çš„objectNameæ ¼å¼å˜æ›´
   - **åº”å¯¹**: ç¼–å†™æ•°æ®è¿ç§»è„šæœ¬ï¼Œä¿æŒå‘åå…¼å®¹

2. **æ–‡ä»¶å­˜å‚¨æœåŠ¡ç¨³å®šæ€§**: MinIOæœåŠ¡çš„å¯ç”¨æ€§
   - **åº”å¯¹**: å®ç°å¤šå­˜å‚¨åç«¯æ”¯æŒï¼Œæ·»åŠ å¥åº·æ£€æŸ¥

3. **å¤§æ–‡ä»¶ä¸Šä¼ æ€§èƒ½**: è§†é¢‘æ–‡ä»¶ä¸Šä¼ é€Ÿåº¦å’Œç¨³å®šæ€§
   - **åº”å¯¹**: å®ç°åˆ†ç‰‡ä¸Šä¼ ã€æ–­ç‚¹ç»­ä¼ 

### ä¸­é£é™©ç‚¹
1. **å‰ç«¯æ€§èƒ½**: å¤§é‡åª’ä½“æ–‡ä»¶çš„æ¸²æŸ“æ€§èƒ½
   - **åº”å¯¹**: è™šæ‹Ÿæ»šåŠ¨ã€æ‡’åŠ è½½ã€å›¾ç‰‡å‹ç¼©

2. **æµè§ˆå™¨å…¼å®¹æ€§**: è§†é¢‘æ’­æ”¾å’Œæ–°APIæ”¯æŒ
   - **åº”å¯¹**: æ·»åŠ polyfillï¼Œé™çº§æ–¹æ¡ˆ

### ä½é£é™©ç‚¹
1. **UI/UXè°ƒæ•´**: ç”¨æˆ·ç•Œé¢çš„å°å¹…è°ƒæ•´
   - **åº”å¯¹**: è¿­ä»£ä¼˜åŒ–ï¼Œæ”¶é›†ç”¨æˆ·åé¦ˆ

## æˆåŠŸæ ‡å‡†

### åŠŸèƒ½æ ‡å‡†
- âœ… ç®¡ç†åç«¯å¯ä»¥æ­£å¸¸ä¸Šä¼ å’Œç®¡ç†å›¾ç‰‡/è§†é¢‘
- âœ… ç”¨æˆ·å‰ç«¯å¯ä»¥æ­£å¸¸æµè§ˆå’Œæ’­æ”¾åª’ä½“å†…å®¹
- âœ… æ–‡ä»¶å­˜å‚¨æœåŠ¡ç¨³å®šè¿è¡Œï¼ŒURLè®¿é—®æ­£å¸¸
- âœ… æ•°æ®è¿ç§»æ— æŸï¼Œå†å²æ•°æ®å®Œæ•´

### æ€§èƒ½æ ‡å‡†
- âœ… å›¾ç‰‡åŠ è½½æ—¶é—´ < 2ç§’
- âœ… è§†é¢‘å¼€å§‹æ’­æ”¾æ—¶é—´ < 5ç§’
- âœ… é¡µé¢å“åº”æ—¶é—´ < 1ç§’
- âœ… æ–‡ä»¶ä¸Šä¼ æˆåŠŸç‡ > 95%

### ç”¨æˆ·ä½“éªŒæ ‡å‡†
- âœ… æ“ä½œæµç¨‹ç›´è§‚ç®€å•
- âœ… é”™è¯¯æç¤ºæ¸…æ™°æœ‰ç”¨
- âœ… ç§»åŠ¨ç«¯é€‚é…è‰¯å¥½
- âœ… æ— éšœç¢è®¿é—®æ”¯æŒ

## æ–‡ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†æ–¹æ¡ˆ

### å­¤å„¿æ–‡ä»¶é—®é¢˜è§£å†³

ä¸ºé¿å…ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡åæ›¿æ¢å¯¼è‡´çš„èµ„æºæµªè´¹ï¼Œå®ç°ä»¥ä¸‹æœºåˆ¶ï¼š

#### 1. ä¸´æ—¶æ–‡ä»¶æœºåˆ¶
- **ä¸Šä¼ æ—¶**: æ–‡ä»¶æ ‡è®°ä¸ºä¸´æ—¶çŠ¶æ€ï¼Œè®¾ç½®24å°æ—¶è¿‡æœŸæ—¶é—´
- **ç¡®è®¤æ—¶**: æ•°æ®ä¿å­˜æˆåŠŸåï¼Œæ–‡ä»¶è½¬ä¸ºæ­£å¼çŠ¶æ€
- **æ›¿æ¢æ—¶**: å‰ç«¯10ç§’å€’è®¡æ—¶åè‡ªåŠ¨æ¸…ç†æ—§æ–‡ä»¶ï¼Œç”¨æˆ·å¯æ’¤é”€

#### 2. æ•°æ®åº“è®¾è®¡
```sql
CREATE TABLE file_upload_records (
    object_name VARCHAR(255) PRIMARY KEY,
    status ENUM('TEMP', 'CONFIRMED', 'DELETED'),
    reference_type VARCHAR(50),
    reference_id VARCHAR(100),
    uploader_id VARCHAR(100),
    upload_time DATETIME,
    confirm_time DATETIME,
    expire_time DATETIME
);
```

#### 3. æ¸…ç†ç­–ç•¥
- **å³æ—¶æ¸…ç†**: æ–‡ä»¶æ›¿æ¢æ—¶10ç§’åè‡ªåŠ¨æ¸…ç†
- **å®šæ—¶æ¸…ç†**: æ¯å°æ—¶æ¸…ç†è¿‡æœŸä¸´æ—¶æ–‡ä»¶
- **æ·±åº¦æ¸…ç†**: æ¯æ—¥æ‰«æå­¤å„¿æ–‡ä»¶ï¼ˆ7å¤©å‰çš„æœªå¼•ç”¨æ–‡ä»¶ï¼‰

#### 4. å‰ç«¯ç”¨æˆ·ä½“éªŒ
- æ–‡ä»¶æ›¿æ¢æ—¶æ˜¾ç¤ºå€’è®¡æ—¶æç¤º
- ç”¨æˆ·å¯æ’¤é”€æ¸…ç†æ“ä½œ
- è¡¨å•å–æ¶ˆæ—¶ç«‹å³æ¸…ç†ä¸´æ—¶æ–‡ä»¶

### å®ç°è¦ç‚¹

1. **å‰ç«¯ç»„ä»¶å¢å¼º**
   - MediaUploadç»„ä»¶é›†æˆæ¸…ç†é€»è¾‘
   - å€’è®¡æ—¶æç¤ºå’Œæ’¤é”€åŠŸèƒ½
   - è¡¨å•ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ç›‘å¬

2. **åç«¯APIæ‰©å±•**
   - `/admin/file/temp/{objectName}` - æ¸…ç†ä¸´æ—¶æ–‡ä»¶
   - `/admin/file/confirm` - ç¡®è®¤æ–‡ä»¶ä½¿ç”¨
   - å®šæ—¶ä»»åŠ¡æ¸…ç†è¿‡æœŸå’Œå­¤å„¿æ–‡ä»¶

3. **å®‰å…¨ä¿éšœ**
   - åªèƒ½æ¸…ç†ä¸´æ—¶çŠ¶æ€æ–‡ä»¶
   - å·²å¼•ç”¨æ–‡ä»¶ä¸ä¼šè¢«è¯¯åˆ 
   - æ“ä½œæ—¥å¿—å’Œé”™è¯¯å¤„ç†

è¿™ä¸ªæ”¹é€ è®¡åˆ’åŸºäºç°æœ‰çš„æˆç†Ÿæ–‡ä»¶å­˜å‚¨æœåŠ¡ï¼Œæœ€å¤§ç¨‹åº¦å¤ç”¨ç°æœ‰ä»£ç ï¼ŒåŒæ—¶æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿç»´æŠ¤æ€§ï¼Œæœ‰æ•ˆé¿å…å­˜å‚¨èµ„æºæµªè´¹ã€‚