# 15-ç”¨æˆ·ç«¯æ¡ˆä¾‹å±•ç¤ºé¡µé¢

## ä»»åŠ¡æ¦‚è¿°
åœ¨ç”¨æˆ·ç«¯(beilv-agent-web)å®ç°æ¡ˆä¾‹å±•ç¤ºé¡µé¢ï¼ŒåŒ…æ‹¬æ¡ˆä¾‹åˆ—è¡¨å±•ç¤ºã€è¯¦æƒ…é¡µé¢ã€åˆ†ç±»ç­›é€‰å’Œæœç´¢åŠŸèƒ½ï¼Œä½¿ç”¨React + Reduxæ¶æ„ã€‚

## å‰ç½®æ¡ä»¶
- 13-é‡æ„Redux-store.md å·²å®Œæˆ
- 14-å®ç°æ‡’åŠ è½½ç»„ä»¶.md å·²å®Œæˆ
- åç«¯mall-portalæ¡ˆä¾‹æŸ¥è¯¢APIå·²éƒ¨ç½²
- UIè®¾è®¡ç¨¿å·²ç¡®è®¤

## å®æ–½æ­¥éª¤

### 1. åˆ›å»ºæ¡ˆä¾‹ç›¸å…³é¡µé¢ç»„ä»¶

#### æ¡ˆä¾‹åˆ—è¡¨é¡µé¢
**æ–‡ä»¶è·¯å¾„ï¼š** `beilv-agent-web/src/pages/Cases/CaseList.jsx`

```jsx
import React, { useEffect, useState } from 'react';
import { useSelector, useDispatch } from 'react-redux';
import { fetchCaseCategories, fetchCases, setSelectedCategory } from '../../store/slices/caseSlice';
import CaseGrid from '../../components/Cases/CaseGrid';
import CategoryFilter from '../../components/Cases/CategoryFilter';
import SearchBar from '../../components/Cases/SearchBar';
import InfiniteLoader from '../../components/Common/InfiniteLoader';
import './CaseList.scss';

const CaseList = () => {
  const dispatch = useDispatch();
  const {
    categories,
    cases,
    selectedCategory,
    loading,
    hasMore,
    searchKeyword
  } = useSelector(state => state.cases);

  const [searchQuery, setSearchQuery] = useState('');

  useEffect(() => {
    // åˆå§‹åŒ–åŠ è½½åˆ†ç±»å’Œæ¡ˆä¾‹
    dispatch(fetchCaseCategories());
    dispatch(fetchCases({ 
      categoryId: selectedCategory,
      page: 1,
      keyword: searchKeyword 
    }));
  }, [dispatch, selectedCategory, searchKeyword]);

  const handleCategoryChange = (categoryId) => {
    dispatch(setSelectedCategory(categoryId));
  };

  const handleSearch = (keyword) => {
    setSearchQuery(keyword);
    dispatch(fetchCases({ 
      categoryId: selectedCategory,
      page: 1,
      keyword: keyword,
      reset: true 
    }));
  };

  const loadMore = () => {
    if (!loading && hasMore) {
      dispatch(fetchCases({ 
        categoryId: selectedCategory,
        keyword: searchQuery,
        loadMore: true 
      }));
    }
  };

  return (
    <div className="case-list-page">
      <div className="page-header">
        <h1 className="page-title">æ¡ˆä¾‹å±•ç¤º</h1>
        <p className="page-description">æ¢ç´¢æˆ‘ä»¬çš„ä¼˜ç§€æ¡ˆä¾‹ä½œå“</p>
      </div>

      <div className="page-content">
        <div className="filter-section">
          <SearchBar
            value={searchQuery}
            onChange={setSearchQuery}
            onSearch={handleSearch}
            placeholder="æœç´¢æ¡ˆä¾‹..."
          />
          <CategoryFilter
            categories={categories}
            selectedCategory={selectedCategory}
            onChange={handleCategoryChange}
          />
        </div>

        <div className="cases-section">
          {cases.length > 0 ? (
            <InfiniteLoader
              hasMore={hasMore}
              loading={loading}
              onLoadMore={loadMore}
            >
              <CaseGrid cases={cases} />
            </InfiniteLoader>
          ) : (
            <div className="empty-state">
              <div className="empty-icon">ğŸ“‹</div>
              <p className="empty-message">
                {loading ? 'åŠ è½½ä¸­...' : 'æš‚æ— æ¡ˆä¾‹æ•°æ®'}
              </p>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default CaseList;
```

#### æ¡ˆä¾‹è¯¦æƒ…é¡µé¢
**æ–‡ä»¶è·¯å¾„ï¼š** `beilv-agent-web/src/pages/Cases/CaseDetail.jsx`

```jsx
import React, { useEffect, useState } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { useDispatch, useSelector } from 'react-redux';
import { fetchCaseDetail, incrementCaseViews } from '../../store/slices/caseSlice';
import ImageGallery from '../../components/Cases/ImageGallery';
import CaseInfo from '../../components/Cases/CaseInfo';
import RelatedCases from '../../components/Cases/RelatedCases';
import LoadingSpinner from '../../components/Common/LoadingSpinner';
import './CaseDetail.scss';

const CaseDetail = () => {
  const { id } = useParams();
  const navigate = useNavigate();
  const dispatch = useDispatch();
  
  const { currentCase, loading, error } = useSelector(state => state.cases);
  const [imageViewerOpen, setImageViewerOpen] = useState(false);
  const [currentImageIndex, setCurrentImageIndex] = useState(0);

  useEffect(() => {
    if (id) {
      dispatch(fetchCaseDetail(id));
      // å¢åŠ æµè§ˆé‡
      dispatch(incrementCaseViews(id));
    }
  }, [dispatch, id]);

  const handleImageClick = (index) => {
    setCurrentImageIndex(index);
    setImageViewerOpen(true);
  };

  const handleBackToList = () => {
    navigate('/cases');
  };

  if (loading) {
    return (
      <div className="case-detail-loading">
        <LoadingSpinner size="large" />
      </div>
    );
  }

  if (error || !currentCase) {
    return (
      <div className="case-detail-error">
        <div className="error-content">
          <h2>æ¡ˆä¾‹æœªæ‰¾åˆ°</h2>
          <p>è¯·æ£€æŸ¥é“¾æ¥æ˜¯å¦æ­£ç¡®æˆ–è¿”å›æ¡ˆä¾‹åˆ—è¡¨</p>
          <button onClick={handleBackToList} className="back-button">
            è¿”å›æ¡ˆä¾‹åˆ—è¡¨
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="case-detail-page">
      <div className="case-detail-header">
        <button onClick={handleBackToList} className="back-button">
          â† è¿”å›åˆ—è¡¨
        </button>
      </div>

      <div className="case-detail-content">
        <div className="case-main">
          <div className="case-images">
            <ImageGallery
              images={currentCase.images}
              onImageClick={handleImageClick}
            />
          </div>

          <div className="case-content">
            <CaseInfo case={currentCase} />
            
            {currentCase.content && (
              <div className="case-description">
                <h3>é¡¹ç›®æè¿°</h3>
                <div
                  className="description-content"
                  dangerouslySetInnerHTML={{ __html: currentCase.content }}
                />
              </div>
            )}
          </div>
        </div>

        <div className="case-sidebar">
          <RelatedCases
            categoryId={currentCase.categoryId}
            excludeId={currentCase.id}
          />
        </div>
      </div>

      {/* å›¾ç‰‡æŸ¥çœ‹å™¨ */}
      {imageViewerOpen && (
        <ImageViewer
          images={currentCase.images}
          currentIndex={currentImageIndex}
          onClose={() => setImageViewerOpen(false)}
          onIndexChange={setCurrentImageIndex}
        />
      )}
    </div>
  );
};

export default CaseDetail;
```

### 2. åˆ›å»ºæ¡ˆä¾‹ç›¸å…³ç»„ä»¶

#### æ¡ˆä¾‹å¡ç‰‡ç»„ä»¶
**æ–‡ä»¶è·¯å¾„ï¼š** `beilv-agent-web/src/components/Cases/CaseCard.jsx`

```jsx
import React from 'react';
import { Link } from 'react-router-dom';
import LazyImage from '../Common/LazyImage';
import './CaseCard.scss';

const CaseCard = ({ caseData, className = '' }) => {
  const {
    id,
    title,
    coverImage,
    categoryName,
    viewCount = 0,
    likeCount = 0,
    createTime
  } = caseData;

  const formatCount = (count) => {
    if (count >= 1000) {
      return `${(count / 1000).toFixed(1)}k`;
    }
    return count.toString();
  };

  const formatDate = (dateString) => {
    const date = new Date(dateString);
    return date.toLocaleDateString('zh-CN');
  };

  return (
    <div className={`case-card ${className}`}>
      <Link to={`/cases/${id}`} className="case-card-link">
        <div className="case-card-image">
          <LazyImage
            src={coverImage}
            alt={title}
            className="cover-image"
            placeholder="/images/case-placeholder.jpg"
          />
          <div className="case-card-overlay">
            <div className="overlay-content">
              <span className="view-detail">æŸ¥çœ‹è¯¦æƒ…</span>
            </div>
          </div>
        </div>

        <div className="case-card-content">
          <h3 className="case-title" title={title}>
            {title}
          </h3>
          
          <div className="case-meta">
            <span className="category">{categoryName}</span>
            <time className="date">{formatDate(createTime)}</time>
          </div>

          <div className="case-stats">
            <div className="stat-item">
              <span className="stat-icon">ğŸ‘</span>
              <span className="stat-value">{formatCount(viewCount)}</span>
            </div>
            <div className="stat-item">
              <span className="stat-icon">â¤ï¸</span>
              <span className="stat-value">{formatCount(likeCount)}</span>
            </div>
          </div>
        </div>
      </Link>
    </div>
  );
};

export default CaseCard;
```

#### æ¡ˆä¾‹ç½‘æ ¼ç»„ä»¶
**æ–‡ä»¶è·¯å¾„ï¼š** `beilv-agent-web/src/components/Cases/CaseGrid.jsx`

```jsx
import React from 'react';
import CaseCard from './CaseCard';
import './CaseGrid.scss';

const CaseGrid = ({ cases = [], className = '' }) => {
  if (cases.length === 0) {
    return null;
  }

  return (
    <div className={`case-grid ${className}`}>
      {cases.map((caseItem) => (
        <CaseCard
          key={caseItem.id}
          caseData={caseItem}
          className="case-grid-item"
        />
      ))}
    </div>
  );
};

export default CaseGrid;
```

#### åˆ†ç±»ç­›é€‰ç»„ä»¶
**æ–‡ä»¶è·¯å¾„ï¼š** `beilv-agent-web/src/components/Cases/CategoryFilter.jsx`

```jsx
import React from 'react';
import './CategoryFilter.scss';

const CategoryFilter = ({
  categories = [],
  selectedCategory,
  onChange,
  className = ''
}) => {
  // æ·»åŠ "å…¨éƒ¨"é€‰é¡¹
  const allCategories = [
    { id: null, name: 'å…¨éƒ¨', count: null },
    { id: 'latest', name: 'æœ€æ–°', count: null },
    { id: 'hot', name: 'çƒ­é—¨', count: null },
    ...categories
  ];

  const handleCategoryClick = (categoryId) => {
    if (onChange) {
      onChange(categoryId);
    }
  };

  return (
    <div className={`category-filter ${className}`}>
      <div className="filter-title">æ¡ˆä¾‹åˆ†ç±»</div>
      <div className="category-list">
        {allCategories.map((category) => (
          <button
            key={category.id || 'all'}
            className={`category-item ${
              selectedCategory === category.id ? 'active' : ''
            }`}
            onClick={() => handleCategoryClick(category.id)}
          >
            <span className="category-name">{category.name}</span>
            {category.count !== null && (
              <span className="category-count">({category.count})</span>
            )}
          </button>
        ))}
      </div>
    </div>
  );
};

export default CategoryFilter;
```

#### æœç´¢æ ç»„ä»¶
**æ–‡ä»¶è·¯å¾„ï¼š** `beilv-agent-web/src/components/Cases/SearchBar.jsx`

```jsx
import React, { useState, useCallback } from 'react';
import { debounce } from 'lodash';
import './SearchBar.scss';

const SearchBar = ({
  value = '',
  onChange,
  onSearch,
  placeholder = 'æœç´¢...',
  className = ''
}) => {
  const [inputValue, setInputValue] = useState(value);

  // é˜²æŠ–æœç´¢
  const debouncedSearch = useCallback(
    debounce((query) => {
      if (onSearch) {
        onSearch(query);
      }
    }, 500),
    [onSearch]
  );

  const handleInputChange = (e) => {
    const query = e.target.value;
    setInputValue(query);
    
    if (onChange) {
      onChange(query);
    }
    
    // è‡ªåŠ¨æœç´¢
    debouncedSearch(query);
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    if (onSearch) {
      onSearch(inputValue);
    }
  };

  const handleClear = () => {
    setInputValue('');
    if (onChange) {
      onChange('');
    }
    if (onSearch) {
      onSearch('');
    }
  };

  return (
    <form className={`search-bar ${className}`} onSubmit={handleSubmit}>
      <div className="search-input-wrapper">
        <input
          type="text"
          className="search-input"
          value={inputValue}
          onChange={handleInputChange}
          placeholder={placeholder}
        />
        
        {inputValue && (
          <button
            type="button"
            className="clear-button"
            onClick={handleClear}
          >
            Ã—
          </button>
        )}
        
        <button type="submit" className="search-button">
          ğŸ”
        </button>
      </div>
    </form>
  );
};

export default SearchBar;
```

### 3. åˆ›å»ºæ ·å¼æ–‡ä»¶

#### æ¡ˆä¾‹åˆ—è¡¨é¡µé¢æ ·å¼
**æ–‡ä»¶è·¯å¾„ï¼š** `beilv-agent-web/src/pages/Cases/CaseList.scss`

```scss
.case-list-page {
  min-height: 100vh;
  background: #f8f9fa;

  .page-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 4rem 0 3rem;
    text-align: center;

    .page-title {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      letter-spacing: -0.025em;
    }

    .page-description {
      font-size: 1.125rem;
      opacity: 0.9;
      max-width: 600px;
      margin: 0 auto;
    }
  }

  .page-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  .filter-section {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);

    .search-bar {
      margin-bottom: 2rem;
    }
  }

  .cases-section {
    .empty-state {
      background: white;
      border-radius: 12px;
      padding: 4rem 2rem;
      text-align: center;

      .empty-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
      }

      .empty-message {
        font-size: 1.125rem;
        color: #6b7280;
      }
    }
  }
}

// å“åº”å¼è®¾è®¡
@media (max-width: 768px) {
  .case-list-page {
    .page-header {
      padding: 2rem 0 1.5rem;

      .page-title {
        font-size: 2rem;
      }

      .page-description {
        font-size: 1rem;
      }
    }

    .page-content {
      padding: 1rem;
    }

    .filter-section {
      padding: 1rem;
    }
  }
}
```

#### æ¡ˆä¾‹å¡ç‰‡æ ·å¼
**æ–‡ä»¶è·¯å¾„ï¼š** `beilv-agent-web/src/components/Cases/CaseCard.scss`

```scss
.case-card {
  background: white;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  height: fit-content;

  &:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);

    .case-card-overlay {
      opacity: 1;
    }
  }

  .case-card-link {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .case-card-image {
    position: relative;
    width: 100%;
    aspect-ratio: 4/3;
    overflow: hidden;

    .cover-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .case-card-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;

      .overlay-content {
        .view-detail {
          color: white;
          font-size: 1rem;
          font-weight: 600;
          padding: 0.75rem 1.5rem;
          border: 2px solid white;
          border-radius: 25px;
          transition: all 0.3s ease;

          &:hover {
            background: white;
            color: #333;
          }
        }
      }
    }
  }

  .case-card-content {
    padding: 1.5rem;

    .case-title {
      font-size: 1.125rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      color: #1f2937;
    }

    .case-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
      font-size: 0.875rem;
      color: #6b7280;

      .category {
        background: #f3f4f6;
        color: #374151;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-weight: 500;
      }
    }

    .case-stats {
      display: flex;
      gap: 1rem;

      .stat-item {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        font-size: 0.875rem;
        color: #6b7280;

        .stat-icon {
          font-size: 1rem;
        }
      }
    }
  }
}
```

### 4. è·¯ç”±é…ç½®

**æ–‡ä»¶è·¯å¾„ï¼š** åœ¨ `beilv-agent-web/src/App.js` ä¸­æ·»åŠ è·¯ç”±

```javascript
// æ·»åŠ æ¡ˆä¾‹ç›¸å…³è·¯ç”±
import CaseList from './pages/Cases/CaseList';
import CaseDetail from './pages/Cases/CaseDetail';

// åœ¨è·¯ç”±é…ç½®ä¸­æ·»åŠ 
<Routes>
  {/* å…¶ä»–è·¯ç”±... */}
  <Route path="/cases" element={<CaseList />} />
  <Route path="/cases/:id" element={<CaseDetail />} />
</Routes>
```

## éªŒè¯æ­¥éª¤
1. å¯åŠ¨ç”¨æˆ·ç«¯åº”ç”¨éªŒè¯é¡µé¢æ­£å¸¸æ¸²æŸ“
2. æµ‹è¯•åˆ†ç±»ç­›é€‰åŠŸèƒ½
3. æµ‹è¯•æœç´¢åŠŸèƒ½
4. éªŒè¯æ— é™æ»šåŠ¨åŠ è½½
5. æµ‹è¯•æ¡ˆä¾‹è¯¦æƒ…é¡µè·³è½¬å’Œæ˜¾ç¤º
6. éªŒè¯å“åº”å¼å¸ƒå±€åœ¨ä¸åŒè®¾å¤‡ä¸Šçš„è¡¨ç°

## è¾“å‡ºç‰©
- æ¡ˆä¾‹å±•ç¤ºç›¸å…³çš„Reacté¡µé¢ç»„ä»¶
- é€šç”¨çš„æ¡ˆä¾‹å±•ç¤ºç»„ä»¶åº“
- å®Œæ•´çš„æ ·å¼æ–‡ä»¶
- è·¯ç”±é…ç½®æ›´æ–°

## æ³¨æ„äº‹é¡¹
1. ç¡®ä¿å›¾ç‰‡æ‡’åŠ è½½å’Œæ— é™æ»šåŠ¨æ€§èƒ½ä¼˜åŒ–
2. é€‚é…ä¸åŒå±å¹•å°ºå¯¸çš„å“åº”å¼è®¾è®¡
3. å¤„ç†åŠ è½½çŠ¶æ€å’Œé”™è¯¯çŠ¶æ€
4. ä¼˜åŒ–SEOç›¸å…³çš„metaä¿¡æ¯

## åç»­ä»»åŠ¡
- ä¸‹ä¸€æ­¥ï¼š16-ç§»åŠ¨ç«¯é€‚é…ä¼˜åŒ–.md