# 03-积分系统开发计划 - 总览

## 阶段概述
**总时间**: 2周 (10个工作日)  
**优先级**: 高  
**目标**: 基于现有mall表结构实现完整的积分管理系统
**依赖**: 02-用户认证系统完成

## 子计划索引

### [03-1: 积分数据库设计和后端服务](./03-1-积分数据库设计和后端服务.md)
**时间**: 第1-3天  
**内容**: 扩展现有mall表结构，实现积分核心服务
- [x] 基于ums_member表的积分字段扩展
- [x] 复用ums_integration_change_history记录表
- [x] 积分服务核心逻辑实现
- [x] 每日免费积分重置机制

### [03-2: 积分API控制器开发](./03-2-积分API控制器开发.md)  
**时间**: 第4-5天
**内容**: 开发积分管理相关的REST API
- [x] 积分余额查询接口
- [x] 积分消费接口（AI任务扣费）
- [x] 积分购买接口（复用现有订单系统）
- [x] 积分历史记录查询接口

### [03-3: 前端积分状态管理](./03-3-前端积分状态管理.md)
**时间**: 第6-7天
**内容**: 前端积分状态管理和API集成
- [x] Redux积分状态切片
- [x] RTK Query积分API集成
- [x] 积分相关自定义Hooks
- [x] 实时积分更新机制

### [03-4: 积分界面组件开发](./03-4-积分界面组件开发.md)
**时间**: 第8-9天
**内容**: 开发积分相关的UI组件
- [x] 积分余额显示组件
- [x] 积分购买页面
- [x] 积分历史记录页面
- [x] 积分不足提示组件

### [03-5: 积分系统集成测试](./03-5-积分系统集成测试.md)
**时间**: 第10天
**内容**: 系统集成测试和优化
- [x] 积分消费流程测试
- [x] 双积分体系验证
- [x] 性能优化
- [x] 错误处理完善

## 核心特性

### 双积分体系
- **免费积分**: 每日200积分，当天有效
- **永久积分**: 购买获得，永不过期
- **消费优先级**: 优先使用免费积分

### 技术实现  
- **复用现有表**: 基于mall系统现有表结构
- **积分商品**: 使用pms_product表，product_type=2标识
- **变动记录**: 复用ums_integration_change_history表
- **规则配置**: 使用ums_member_rule_setting管理每日积分规则

## 验收标准
- [x] 双积分体系正确工作
- [x] 积分购买和消费流程完整
- [x] 历史记录准确完整
- [x] 与AI任务系统正确集成