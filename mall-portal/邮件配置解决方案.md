# 邮件服务配置解决方案

## 问题分析
当前邮件发送失败的原因：
```
jakarta.mail.AuthenticationFailedException: 535 Login fail
```

## 解决方案

### 方案1：使用QQ邮箱(推荐用于测试)

1. **更新.env文件**:
```env
# QQ邮箱配置
MAIL_HOST=smtp.qq.com
MAIL_PORT=587
MAIL_USERNAME=你的QQ号@qq.com
MAIL_PASSWORD=你的QQ邮箱授权码
MAIL_FROM_NAME=BEILV AI
MAIL_FROM_ADDRESS=你的QQ号@qq.com
MAIL_SSL_ENABLE=false
MAIL_PROTOCOL=smtp
```

2. **获取QQ邮箱授权码**:
   - 登录QQ邮箱 -> 设置 -> 账户
   - 找到"POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务"
   - 开启"IMAP/SMTP服务"
   - 获取授权码（16位随机字符）

3. **更新application-dev.yml**:
```yaml
spring:
  mail:
    host: ${MAIL_HOST:smtp.qq.com}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    protocol: smtp
    default-encoding: UTF-8
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          ssl:
            trust: "*"
          connectiontimeout: 30000
          timeout: 30000
```

### 方案2：使用Gmail（国外用户）

```env
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=你的gmail地址
MAIL_PASSWORD=应用专用密码
MAIL_SSL_ENABLE=false
```

### 方案3：使用163邮箱

```env
MAIL_HOST=smtp.163.com
MAIL_PORT=25
MAIL_USERNAME=你的163邮箱
MAIL_PASSWORD=客户端授权密码
MAIL_SSL_ENABLE=false
```

### 方案4：开发环境模拟发送（临时方案）

如果邮件配置复杂，可以在开发环境暂时使用模拟发送：

1. 在MailServiceImpl中添加开发环境判断
2. 开发环境下只打印日志，不实际发送邮件
3. 验证码直接返回固定值（如：123456）

## 测试命令

配置完成后，可以使用curl测试：

```bash
curl -X POST http://localhost:8085/api/auth/send-code \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","codeType":2}'
```

## 建议

1. **推荐使用QQ邮箱进行测试**，配置相对简单
2. **生产环境建议使用企业邮箱**，更专业可靠  
3. **开发阶段可以使用模拟发送**，提高开发效率